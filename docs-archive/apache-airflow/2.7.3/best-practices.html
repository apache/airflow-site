



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
        <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Best Practices &mdash; Airflow Documentation</title>
    <link rel="stylesheet" href="_static/_gen/css/main.min.css" type="text/css" />
            <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
            <link rel="stylesheet" type="text/css" href="_static/_gen/css/main.min.css" />
            <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
            <link rel="stylesheet" type="text/css" href="_static/_gen/css/main-custom.min.css" />
            <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
            <link rel="shortcut icon" href="_static/pin_32.png"/>
            <link rel="index" title="Index" href="genindex.html" />
            <link rel="search" title="Search" href="search.html" />
            <link rel="next" title="FAQ" href="faq.html" />
            <link rel="prev" title="airflow.decorators.task_group" href="_api/airflow/decorators/task_group/index.html" />

    <link rel="canonical" href="https://airflow.apache.org/docs/apache-airflow/stable/best-practices.html" />

    <!-- Matomo -->
    <script>
        var _paq = window._paq = window._paq || [];
        /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
        /* We explicitly disable cookie tracking to avoid privacy issues */
        _paq.push(['disableCookies']);
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
        var u="https://analytics.apache.org/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '13']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
        })();
    </script>
    <!-- End Matomo Code -->

    
</head><body class="td-section">
    

<header>
    <nav class="js-navbar-scroll navbar">
        <div class="navbar__icon-container">
            <a href="/">
                <svg xmlns="http://www.w3.org/2000/svg" width="155.314" height="60" viewBox="0 0 155.314 60">
                    <defs>
                        <clipPath id="clip-path">
                            <path id="Rectangle_1" d="M0 0h155.314v60H0z" fill="none" data-name="Rectangle 1"></path>
                        </clipPath>
                    </defs>
                    <g id="logo" transform="translate(-1305 -780.355)">
                        <g id="Group_2" clip-path="url(#clip-path)" data-name="Group 2" transform="translate(1305 780.355)">
                            <g id="Group_1" data-name="Group 1" transform="translate(.486 .486)">
                                <path id="Path_1" d="M1307.562 880.867l28.187-28.893a.521.521 0 0 0 .063-.666c-1.714-2.393-4.877-2.808-6.049-4.416-3.472-4.763-4.353-7.459-5.845-7.292a.456.456 0 0 0-.271.143l-10.182 10.438c-5.858 6-6.7 19.225-6.852 30.3a.552.552 0 0 0 .949.386z" fill="#017cee" data-name="Path 1" transform="translate(-1306.613 -822.232)"></path>
                                <path id="Path_2" d="M1405.512 908.489l-28.893-28.189a.521.521 0 0 0-.667-.063c-2.393 1.715-2.808 4.877-4.416 6.049-4.763 3.472-7.459 4.353-7.292 5.845a.456.456 0 0 0 .143.27l10.438 10.182c6 5.858 19.225 6.7 30.3 6.852a.552.552 0 0 0 .387-.946z" fill="#00ad46" data-name="Path 2" transform="translate(-1346.876 -850.567)"></path>
                                <path id="Path_3" d="M1373.909 902.252c-3.28-3.2-4.8-9.53 1.486-22.583-10.219 4.567-13.8 10.57-12.039 12.289z" fill="#04d659" data-name="Path 3" transform="translate(-1345.96 -850.233)"></path>
                                <path id="Path_4" d="M1433.132 782.359l-28.186 28.893a.52.52 0 0 0-.063.666c1.715 2.393 4.876 2.808 6.049 4.416 3.472 4.763 4.354 7.459 5.845 7.292a.454.454 0 0 0 .271-.143l10.182-10.438c5.858-6 6.7-19.225 6.852-30.3a.553.553 0 0 0-.95-.386z" fill="#00c7d4" data-name="Path 4" transform="translate(-1375.21 -782.123)"></path>
                                <path id="Path_5" d="M1426.9 881.155c-3.2 3.28-9.53 4.8-22.584-1.486 4.567 10.219 10.57 13.8 12.289 12.039z" fill="#11e1ee" data-name="Path 5" transform="translate(-1374.875 -850.233)"></path>
                                <path id="Path_6" d="M1307 782.919l28.893 28.186a.521.521 0 0 0 .666.063c2.393-1.715 2.808-4.877 4.416-6.049 4.763-3.472 7.459-4.353 7.292-5.845a.459.459 0 0 0-.143-.271l-10.438-10.182c-6-5.858-19.225-6.7-30.3-6.852a.552.552 0 0 0-.386.95z" fill="#e43921" data-name="Path 6" transform="translate(-1306.766 -781.97)"></path>
                                <path id="Path_7" d="M1405.8 804.711c3.28 3.2 4.8 9.53-1.486 22.584 10.219-4.567 13.8-10.571 12.039-12.289z" fill-rule="evenodd" fill="#ff7557" data-name="Path 7" transform="translate(-1374.875 -797.859)"></path>
                                <path id="Path_8" d="M1329.355 849.266c3.2-3.28 9.53-4.8 22.584 1.486-4.567-10.219-10.57-13.8-12.289-12.039z" fill="#0cb6ff" data-name="Path 8" transform="translate(-1322.503 -821.316)"></path>
                                <circle id="Ellipse_1" cx="1.26" cy="1.26" r="1.26" fill="#4a4848" data-name="Ellipse 1" transform="translate(28.18 28.171)"></circle>
                                <path id="Path_9" d="M1527.558 827.347a.229.229 0 0 1-.223-.223.458.458 0 0 1 .011-.123l2.766-7.214a.346.346 0 0 1 .357-.245h.758a.348.348 0 0 1 .357.245l2.754 7.214.022.123a.228.228 0 0 1-.223.223h-.568a.288.288 0 0 1-.19-.056.352.352 0 0 1-.089-.134l-.613-1.583h-3.657l-.613 1.583a.317.317 0 0 1-.1.134.269.269 0 0 1-.178.056zm4.795-2.732l-1.505-3.958-1.505 3.958zm3.322 4.85a.258.258 0 0 1-.189-.078.241.241 0 0 1-.067-.178v-7.4a.241.241 0 0 1 .067-.178.258.258 0 0 1 .189-.078h.513a.268.268 0 0 1 .256.256v.49a2.118 2.118 0 0 1 1.828-.858 2.092 2.092 0 0 1 1.751.736 3.135 3.135 0 0 1 .636 1.9q.011.122.011.379t-.011.379a3.168 3.168 0 0 1-.636 1.9 2.111 2.111 0 0 1-1.751.736 2.154 2.154 0 0 1-1.806-.836v2.587a.241.241 0 0 1-.067.178.223.223 0 0 1-.179.078zm2.364-2.91a1.324 1.324 0 0 0 1.149-.491 2.266 2.266 0 0 0 .4-1.293q.011-.111.011-.323 0-2.107-1.562-2.107a1.365 1.365 0 0 0-1.159.513 2.111 2.111 0 0 0-.412 1.2l-.012.424.012.435a1.862 1.862 0 0 0 .424 1.149 1.4 1.4 0 0 0 1.148.493zm5.628.9a2.329 2.329 0 0 1-1.015-.223 1.94 1.94 0 0 1-.747-.6 1.487 1.487 0 0 1-.268-.859 1.459 1.459 0 0 1 .6-1.2 3.4 3.4 0 0 1 1.65-.624l1.661-.234v-.323q0-1.137-1.3-1.137a1.4 1.4 0 0 0-.8.212 1.376 1.376 0 0 0-.468.48.305.305 0 0 1-.089.145.18.18 0 0 1-.134.045h-.48a.23.23 0 0 1-.245-.245 1.17 1.17 0 0 1 .245-.6 1.931 1.931 0 0 1 .747-.591 2.7 2.7 0 0 1 1.238-.256 2.351 2.351 0 0 1 1.8.591 2.032 2.032 0 0 1 .547 1.45v3.613a.257.257 0 0 1-.078.19.24.24 0 0 1-.178.067h-.513a.233.233 0 0 1-.257-.256v-.479a1.923 1.923 0 0 1-.714.6 2.557 2.557 0 0 1-1.203.237zm.234-.836a1.579 1.579 0 0 0 1.182-.469 1.881 1.881 0 0 0 .468-1.371v-.312l-1.293.19a2.918 2.918 0 0 0-1.193.379.761.761 0 0 0-.4.658.784.784 0 0 0 .368.691 1.585 1.585 0 0 0 .867.237zm6.643.836a2.556 2.556 0 0 1-1.873-.669 2.738 2.738 0 0 1-.714-1.9l-.011-.446.011-.446a2.7 2.7 0 0 1 .714-1.885 2.531 2.531 0 0 1 1.873-.68 2.917 2.917 0 0 1 1.36.29 2.077 2.077 0 0 1 .825.714 1.7 1.7 0 0 1 .3.848.2.2 0 0 1-.067.178.281.281 0 0 1-.19.067h-.535a.265.265 0 0 1-.168-.045.458.458 0 0 1-.111-.178 1.428 1.428 0 0 0-.535-.758 1.516 1.516 0 0 0-.87-.234 1.45 1.45 0 0 0-1.1.435 1.952 1.952 0 0 0-.435 1.3l-.011.4.011.379a1.969 1.969 0 0 0 .435 1.316 1.446 1.446 0 0 0 1.1.424 1.577 1.577 0 0 0 .87-.223 1.493 1.493 0 0 0 .535-.769.458.458 0 0 1 .111-.178.228.228 0 0 1 .168-.056h.535a.258.258 0 0 1 .19.078.2.2 0 0 1 .067.178 1.75 1.75 0 0 1-.3.847 2.078 2.078 0 0 1-.825.714 2.876 2.876 0 0 1-1.361.302zm4.078-.112a.233.233 0 0 1-.257-.256v-7.4a.241.241 0 0 1 .067-.178.259.259 0 0 1 .19-.078h.557a.267.267 0 0 1 .257.256v2.6a2.167 2.167 0 0 1 .758-.624 2.353 2.353 0 0 1 1.082-.223 2.067 2.067 0 0 1 1.661.691 2.642 2.642 0 0 1 .6 1.818v3.144a.257.257 0 0 1-.078.19.24.24 0 0 1-.178.067h-.557a.233.233 0 0 1-.256-.256V824a1.775 1.775 0 0 0-.39-1.227 1.387 1.387 0 0 0-1.1-.435 1.481 1.481 0 0 0-1.126.446 1.7 1.7 0 0 0-.412 1.215v3.088a.257.257 0 0 1-.078.19.24.24 0 0 1-.178.067zm8.846.112a2.466 2.466 0 0 1-1.84-.7 2.938 2.938 0 0 1-.747-1.94l-.011-.379.011-.368a2.953 2.953 0 0 1 .758-1.918 2.7 2.7 0 0 1 3.735.078 3.114 3.114 0 0 1 .68 2.119v.19a.257.257 0 0 1-.078.189.241.241 0 0 1-.178.067h-3.858v.1a2.11 2.11 0 0 0 .435 1.238 1.332 1.332 0 0 0 1.081.5 1.563 1.563 0 0 0 .836-.2 1.7 1.7 0 0 0 .491-.435.6.6 0 0 1 .145-.156.391.391 0 0 1 .19-.033h.547a.252.252 0 0 1 .167.056.192.192 0 0 1 .067.156.975.975 0 0 1-.312.591 2.51 2.51 0 0 1-.859.6 3.049 3.049 0 0 1-1.26.248zm1.527-3.434v-.033a1.817 1.817 0 0 0-.424-1.249 1.512 1.512 0 0 0-2.23 0 1.883 1.883 0 0 0-.4 1.249v.033z" fill="#51504f" data-name="Path 9" transform="translate(-1460.834 -808.144)"></path>
                                <path id="Path_10" d="M1527.2 827.081l-.061.061zm-.056-.279l-.08-.031zm2.766-7.214l.08.031zm1.472 0l-.081.029zm2.754 7.214l.084-.015a.064.064 0 0 0 0-.015zm.022.123h.086v-.015zm-.067.156l.06.061zm-.914.011l-.061.061.006.005zm-.089-.134l.081-.027zm-.613-1.583l.08-.031a.086.086 0 0 0-.08-.055zm-3.657 0v-.086a.086.086 0 0 0-.08.055zm-.613 1.583l-.08-.031zm-.1.134l.055.066zm4.047-2.676v.086a.086.086 0 0 0 .08-.116zm-1.505-3.958l.08-.03a.086.086 0 0 0-.16 0zm-1.505 3.958l-.08-.03a.086.086 0 0 0 .08.116zm-1.784 2.646a.128.128 0 0 1-.1-.042l-.122.121a.3.3 0 0 0 .217.092zm-.1-.042a.129.129 0 0 1-.042-.1h-.171a.3.3 0 0 0 .092.217zm-.042-.1a.38.38 0 0 1 .007-.1l-.163-.054a.514.514 0 0 0-.016.15zm.005-.092l2.765-7.214-.16-.061-2.765 7.214zm2.766-7.216a.283.283 0 0 1 .1-.143.3.3 0 0 1 .174-.046v-.172a.47.47 0 0 0-.271.076.453.453 0 0 0-.166.226zm.276-.189h.758v-.172h-.758zm.758 0a.3.3 0 0 1 .175.046.283.283 0 0 1 .1.143l.161-.059a.451.451 0 0 0-.166-.226.47.47 0 0 0-.272-.076zm.277.19l2.754 7.214.16-.061-2.754-7.214zm2.75 7.2l.022.123.169-.031-.022-.123zm.021.107a.13.13 0 0 1-.042.1l.121.121a.3.3 0 0 0 .092-.217zm-.042.1a.13.13 0 0 1-.1.042v.171a.3.3 0 0 0 .217-.092zm-.1.042h-.568v.171h.568zm-.568 0a.206.206 0 0 1-.135-.036l-.11.132a.373.373 0 0 0 .245.076zm-.129-.031a.262.262 0 0 1-.069-.1l-.162.054a.431.431 0 0 0 .11.167zm-.07-.1l-.613-1.584-.16.062.613 1.583zm-.693-1.638h-3.657v.171h3.657zm-3.737.055l-.614 1.584.16.062.613-1.583zm-.615 1.587a.235.235 0 0 1-.075.1l.111.13a.4.4 0 0 0 .126-.172zm-.074.1a.185.185 0 0 1-.124.036v.171a.354.354 0 0 0 .233-.076zm-.124.036h-.569v.171h.569zm4.306-2.677l-1.505-3.958-.16.061 1.505 3.958zm-1.666-3.958l-1.505 3.958.16.061 1.505-3.958zm-1.425 4.075h3.01v-.171h-3.01zm6.143 4.687l-.06.061zm0-7.761l.061.061zm.881 0l-.065.056.01.009zm.078.669h-.086a.086.086 0 0 0 .155.051zm3.579-.123l-.067.053zm.636 1.9h-.086zm0 .758l-.085-.007zm-.636 1.9l.067.054zm-3.557-.1l.068-.052a.086.086 0 0 0-.154.052zm-.067 2.765l-.061-.06zm2.787-3.323l-.069-.051zm.4-1.293l-.085-.008v.005zm-2.709-1.918l-.068-.052zm-.413 1.2h-.086zm-.011.423h-.085zm.011.435h-.086zm.424 1.149l.066-.054zm-1.216 3.315a.173.173 0 0 1-.129-.053l-.121.121a.342.342 0 0 0 .25.1zm-.129-.053a.157.157 0 0 1-.042-.118h-.172a.325.325 0 0 0 .092.239zm-.042-.118v-7.4h-.172v7.4zm0-7.4a.157.157 0 0 1 .042-.118l-.121-.121a.324.324 0 0 0-.092.239zm.042-.118a.173.173 0 0 1 .129-.053v-.172a.342.342 0 0 0-.25.1zm.129-.053h.513v-.172h-.513zm.513 0a.137.137 0 0 1 .113.048l.13-.111a.309.309 0 0 0-.244-.108zm.123.058a.137.137 0 0 1 .048.113h.171a.309.309 0 0 0-.108-.243zm.048.113v.49h.171v-.49zm.155.541a2.033 2.033 0 0 1 1.759-.823v-.171a2.2 2.2 0 0 0-1.9.894zm1.759-.823a2.007 2.007 0 0 1 1.683.7l.135-.106a2.177 2.177 0 0 0-1.818-.768zm1.683.7a3.045 3.045 0 0 1 .617 1.845l.171-.007a3.218 3.218 0 0 0-.654-1.946zm.617 1.85c.007.078.011.2.011.372h.171c0-.171 0-.3-.012-.387zm.011.372c0 .171 0 .294-.011.372l.17.015c.008-.086.012-.216.012-.387zm-.011.376a3.08 3.08 0 0 1-.617 1.846l.134.106a3.25 3.25 0 0 0 .654-1.945zm-.617 1.845a2.025 2.025 0 0 1-1.683.7v.171a2.2 2.2 0 0 0 1.817-.768zm-1.683.7a2.068 2.068 0 0 1-1.739-.8l-.136.1a2.239 2.239 0 0 0 1.874.87zm-1.892-.75v2.587h.172v-2.587zm0 2.587a.156.156 0 0 1-.042.118l.121.121a.325.325 0 0 0 .092-.239zm-.046.123a.138.138 0 0 1-.114.048v.172a.308.308 0 0 0 .244-.108zm-.114.048h-.546v.172h.546zm1.817-2.739a1.408 1.408 0 0 0 1.218-.526l-.138-.1a1.24 1.24 0 0 1-1.079.455zm1.217-.525a2.355 2.355 0 0 0 .419-1.341l-.171-.007a2.182 2.182 0 0 1-.385 1.246zm.418-1.336c.008-.079.012-.19.012-.332h-.172c0 .14 0 .245-.011.315zm.012-.332a2.726 2.726 0 0 0-.407-1.632 1.448 1.448 0 0 0-1.24-.562v.171a1.278 1.278 0 0 1 1.1.492 2.565 2.565 0 0 1 .374 1.53zm-1.647-2.193a1.452 1.452 0 0 0-1.228.547l.136.1a1.282 1.282 0 0 1 1.091-.479zm-1.228.547a2.2 2.2 0 0 0-.43 1.252l.172.008a2.028 2.028 0 0 1 .4-1.157zm-.43 1.254l-.011.424h.171l.011-.424zm-.011.428l.011.435h.172l-.011-.435zm.011.436a1.95 1.95 0 0 0 .443 1.2l.133-.109a1.776 1.776 0 0 1-.4-1.1zm.443 1.2a1.484 1.484 0 0 0 1.214.522v-.171a1.314 1.314 0 0 1-1.082-.459zm5.828 1.117l.037-.077zm-.747-.6l-.07.049zm.335-2.063l.052.068zm1.65-.624l.012.085zm1.661-.234l.012.085a.086.086 0 0 0 .074-.085zm-2.107-1.249l.046.072zm-.468.48l-.075-.042a.083.083 0 0 0-.006.015zm-.089.145l-.054-.067-.007.006zm-.792-.022l-.065.056.009.009zm-.067-.178h-.086zm.245-.6l-.07-.049zm.747-.591l.038.077zm3.033.334l-.063.058zm.468 5.252l.06.061zm-.881 0l-.065.056a.043.043 0 0 0 .009.009zm-.067-.669h.086a.086.086 0 0 0-.156-.048zm-.714.6l-.04-.076zm.223-1.059l-.062-.06zm.468-1.684h.086a.086.086 0 0 0-.1-.085zm-1.293.189l.012.085zm-1.193.379l.046.072zm-.033 1.349l-.047.071zm.635.985a2.241 2.241 0 0 1-.978-.215l-.074.155a2.412 2.412 0 0 0 1.051.231zm-.978-.215a1.859 1.859 0 0 1-.715-.576l-.138.1a2.024 2.024 0 0 0 .779.629zm-.713-.573a1.4 1.4 0 0 1-.253-.81h-.172a1.571 1.571 0 0 0 .283.907zm-.253-.81a1.374 1.374 0 0 1 .569-1.136l-.105-.135a1.544 1.544 0 0 0-.635 1.272zm.569-1.137a3.316 3.316 0 0 1 1.609-.607l-.024-.17a3.481 3.481 0 0 0-1.691.642zm1.609-.607l1.661-.234-.024-.17-1.662.234zm1.735-.319v-.323h-.171v.323zm0-.323a1.156 1.156 0 0 0-.355-.917 1.536 1.536 0 0 0-1.035-.306v.172a1.37 1.37 0 0 1 .922.263.986.986 0 0 1 .3.788zm-1.39-1.223a1.486 1.486 0 0 0-.851.227l.1.142a1.316 1.316 0 0 1 .755-.2zm-.849.226a1.452 1.452 0 0 0-.5.51l.15.084a1.286 1.286 0 0 1 .44-.449zm-.5.524a.226.226 0 0 1-.062.105l.107.134a.391.391 0 0 0 .117-.185zm-.068.112a.1.1 0 0 1-.073.019v.171a.266.266 0 0 0 .194-.07zm-.073.019h-.48v.171h.48zm-.48 0a.18.18 0 0 1-.122-.046l-.112.13a.352.352 0 0 0 .234.087zm-.113-.037a.18.18 0 0 1-.047-.123h-.171a.352.352 0 0 0 .087.234zm-.047-.119a1.1 1.1 0 0 1 .23-.557l-.14-.1a1.253 1.253 0 0 0-.261.648zm.23-.556a1.843 1.843 0 0 1 .715-.564l-.075-.154a2.018 2.018 0 0 0-.78.618zm.716-.564a2.611 2.611 0 0 1 1.2-.247v-.171a2.781 2.781 0 0 0-1.277.266zm1.2-.247a2.268 2.268 0 0 1 1.732.563l.126-.116a2.435 2.435 0 0 0-1.858-.618zm1.733.564a1.945 1.945 0 0 1 .523 1.391h.171a2.117 2.117 0 0 0-.57-1.508zm.523 1.391v3.613h.171v-3.613zm0 3.613a.172.172 0 0 1-.053.129l.121.121a.344.344 0 0 0 .1-.25zm-.053.129a.157.157 0 0 1-.118.042v.171a.326.326 0 0 0 .239-.092zm-.118.042h-.513v.171h.513zm-.513 0a.2.2 0 0 1-.134-.046l-.111.13a.367.367 0 0 0 .245.088zm-.124-.037a.194.194 0 0 1-.047-.134h-.171a.366.366 0 0 0 .087.245zm-.047-.134v-.479h-.171v.479zm-.156-.528a1.846 1.846 0 0 1-.683.575l.079.152a2.012 2.012 0 0 0 .745-.629zm-.683.575a2.476 2.476 0 0 1-1.153.236v.171a2.644 2.644 0 0 0 1.233-.255zm-.919-.429a1.666 1.666 0 0 0 1.244-.494l-.123-.12a1.493 1.493 0 0 1-1.121.442zm1.244-.494a1.969 1.969 0 0 0 .492-1.431h-.171a1.8 1.8 0 0 1-.444 1.312zm.492-1.431v-.312h-.171v.312zm-.1-.4l-1.293.189.025.17 1.293-.189zm-1.293.189a3 3 0 0 0-1.228.393l.095.143a2.837 2.837 0 0 1 1.158-.365zm-1.227.392a.845.845 0 0 0-.441.73h.172a.676.676 0 0 1 .362-.586zm-.441.73a.869.869 0 0 0 .406.762l.095-.142a.7.7 0 0 1-.33-.62zm.408.764a1.673 1.673 0 0 0 .916.247v-.171a1.5 1.5 0 0 1-.823-.221zm5.686.329l-.061.06zm-.714-1.9h-.085zm-.011-.446h-.085zm.011-.446h-.085zm.714-1.885l.061.061zm3.234-.39l-.04.076zm.825.713l-.073.046zm.3.848h-.086zm-.067.178l.056.065zm-.892.022l.054-.067zm-.112-.178l-.081.029zm-.535-.758l-.048.071zm-1.974.2l-.062-.059zm-.435 1.3h-.086zm-.011.4h-.086zm.011.379h-.086zm.435 1.316l-.062.059zm1.974.2l.046.072zm.535-.769l-.079-.033zm.112-.178l.054.067.007-.006zm.892.022l-.061.06zm.067.178l-.085-.009zm-.3.847l-.072-.046zm-.825.714l-.04-.076zm-1.36.2a2.471 2.471 0 0 1-1.814-.644l-.12.122a2.64 2.64 0 0 0 1.933.694zm-1.813-.643a2.653 2.653 0 0 1-.689-1.839l-.171.006a2.822 2.822 0 0 0 .738 1.952zm-.689-1.838l-.011-.446h-.171l.011.446zm-.011-.442l.011-.446h-.171l-.011.446zm.011-.445a2.611 2.611 0 0 1 .689-1.827l-.122-.121a2.78 2.78 0 0 0-.738 1.942zm.689-1.827a2.447 2.447 0 0 1 1.813-.655v-.171a2.617 2.617 0 0 0-1.934.705zm1.813-.655a2.836 2.836 0 0 1 1.32.28l.079-.152a3 3 0 0 0-1.4-.3zm1.32.28a1.99 1.99 0 0 1 .792.683l.145-.091a2.158 2.158 0 0 0-.858-.744zm.793.685a1.617 1.617 0 0 1 .287.8l.171-.009a1.789 1.789 0 0 0-.315-.89zm.287.809a.11.11 0 0 1-.037.1l.112.13a.281.281 0 0 0 .1-.252zm-.037.1a.2.2 0 0 1-.134.046v.171a.369.369 0 0 0 .246-.088zm-.134.046h-.535v.171h.535zm-.535 0a.184.184 0 0 1-.114-.026l-.107.134a.345.345 0 0 0 .221.064zm-.114-.026a.389.389 0 0 1-.086-.144l-.158.066a.533.533 0 0 0 .137.212zm-.084-.14a1.514 1.514 0 0 0-.57-.8l-.093.144a1.343 1.343 0 0 1 .5.715zm-.568-.8a1.6 1.6 0 0 0-.918-.249v.171a1.435 1.435 0 0 1 .822.219zm-.918-.249a1.535 1.535 0 0 0-1.166.462l.124.118a1.364 1.364 0 0 1 1.042-.408zm-1.166.462a2.036 2.036 0 0 0-.458 1.36l.171.006a1.872 1.872 0 0 1 .411-1.249zm-.458 1.361l-.011.4h.171l.011-.4zm-.011.406l.011.379.171-.005-.011-.379zm.011.38a2.052 2.052 0 0 0 .458 1.371l.124-.118a1.889 1.889 0 0 1-.411-1.26zm.458 1.371a1.533 1.533 0 0 0 1.166.451v-.172a1.363 1.363 0 0 1-1.042-.4zm1.166.451a1.661 1.661 0 0 0 .916-.237l-.093-.144a1.491 1.491 0 0 1-.823.209zm.918-.238a1.576 1.576 0 0 0 .568-.812l-.162-.057a1.409 1.409 0 0 1-.5.727zm.566-.807a.39.39 0 0 1 .086-.144l-.107-.134a.533.533 0 0 0-.137.213zm.093-.151a.144.144 0 0 1 .107-.031v-.171a.31.31 0 0 0-.228.081zm.107-.031h.535v-.171h-.535zm.535 0a.173.173 0 0 1 .129.053l.121-.121a.344.344 0 0 0-.25-.1zm.134.057a.11.11 0 0 1 .037.1l.17.017a.281.281 0 0 0-.1-.252zm.037.109a1.664 1.664 0 0 1-.288.806l.144.092a1.839 1.839 0 0 0 .315-.889zm-.288.806a1.989 1.989 0 0 1-.792.683l.079.152a2.162 2.162 0 0 0 .858-.744zm-.793.684a2.8 2.8 0 0 1-1.32.28v.171a2.96 2.96 0 0 0 1.4-.3zm2.568.187l-.065.056.01.009zm0-7.772l.061.06zm.926 0l-.065.056.009.009zm.078 2.776h-.085a.086.086 0 0 0 .153.053zm.758-.624l.038.077zm2.743.468l-.065.056zm.524 5.151l-.061-.06zm-.925 0l-.065.056.009.009zm-.457-4.5l-.065.056zm-2.23.011l-.062-.059zm-.49 4.493l-.061-.06zm-.736-.019a.2.2 0 0 1-.134-.046l-.112.13a.367.367 0 0 0 .245.088zm-.124-.037a.2.2 0 0 1-.046-.134h-.172a.367.367 0 0 0 .087.245zm-.046-.134v-7.4h-.172v7.4zm0-7.4a.156.156 0 0 1 .042-.118l-.121-.121a.326.326 0 0 0-.092.239zm.042-.118a.172.172 0 0 1 .129-.053v-.171a.343.343 0 0 0-.25.1zm.129-.053h.557v-.171h-.557zm.557 0a.137.137 0 0 1 .113.048l.13-.112a.308.308 0 0 0-.244-.108zm.122.057a.137.137 0 0 1 .048.113h.172a.309.309 0 0 0-.108-.243zm.048.113v2.6h.172v-2.6zm.153 2.651a2.076 2.076 0 0 1 .728-.6l-.075-.154a2.248 2.248 0 0 0-.788.649zm.73-.6a2.272 2.272 0 0 1 1.043-.214v-.171a2.438 2.438 0 0 0-1.121.232zm1.043-.214a1.982 1.982 0 0 1 1.6.661l.13-.112a2.152 2.152 0 0 0-1.727-.721zm1.6.663a2.557 2.557 0 0 1 .581 1.761h.171a2.727 2.727 0 0 0-.624-1.874zm.581 1.761v3.144h.171v-3.144zm0 3.144a.173.173 0 0 1-.053.129l.121.121a.345.345 0 0 0 .1-.25zm-.053.129a.156.156 0 0 1-.118.042v.171a.327.327 0 0 0 .239-.092zm-.118.042h-.557v.171h.557zm-.557 0a.2.2 0 0 1-.134-.046l-.112.13a.367.367 0 0 0 .245.088zm-.124-.037a.2.2 0 0 1-.046-.134h-.172a.368.368 0 0 0 .087.245zm-.046-.134V823.8h-.172v3.088zm0-3.088a1.859 1.859 0 0 0-.412-1.284l-.128.114a1.69 1.69 0 0 1 .368 1.169zm-.411-1.283a1.471 1.471 0 0 0-1.169-.464v.171a1.3 1.3 0 0 1 1.039.406zm-1.169-.464a1.566 1.566 0 0 0-1.188.473l.124.118a1.4 1.4 0 0 1 1.064-.419zm-1.188.473a1.779 1.779 0 0 0-.436 1.275h.172a1.609 1.609 0 0 1 .389-1.156zm-.436 1.275v3.088h.172V823.8zm0 3.088a.172.172 0 0 1-.053.129l.121.121a.344.344 0 0 0 .1-.25zm-.053.129a.156.156 0 0 1-.118.042v.171a.327.327 0 0 0 .239-.092zm-.118.042h-.557v.171h.557zm6.449-.505l-.062.059zm-.747-1.94h-.086zm-.012-.379h-.085v.005zm.012-.368l-.086-.006zm.758-1.918l-.061-.06zm3.735.078l-.065.056zm.6 2.5l.061.061zm-4.036.067v-.086a.086.086 0 0 0-.086.086zm0 .1h-.086zm.435 1.238l-.068.053zm1.918.3l.045.073zm.491-.435l-.069-.051zm.145-.156l.039.077h.006zm.9.022l-.055.066zm-.245.747l-.064-.057zm-.858.6l.035.078zm.267-3.189v.086a.086.086 0 0 0 .086-.086zm-.424-1.282l-.066.055zm-2.23 0l-.065-.055zm-.4 1.282h-.086a.086.086 0 0 0 .086.086zm1.528 3.349a2.38 2.38 0 0 1-1.779-.677l-.122.12a2.55 2.55 0 0 0 1.9.728zm-1.778-.676a2.86 2.86 0 0 1-.724-1.886l-.171.009a3.027 3.027 0 0 0 .771 1.995zm-.723-1.884l-.011-.379h-.171l.011.379zm-.011-.374l.011-.368-.172-.005-.011.368zm.011-.365a2.871 2.871 0 0 1 .735-1.864l-.124-.118a3.042 3.042 0 0 0-.782 1.971zm.734-1.864a2.331 2.331 0 0 1 1.756-.687v-.171a2.5 2.5 0 0 0-1.879.74zm1.756-.687a2.307 2.307 0 0 1 1.853.762l.13-.112a2.477 2.477 0 0 0-1.983-.821zm1.854.762a3.03 3.03 0 0 1 .659 2.062h.172a3.2 3.2 0 0 0-.7-2.175zm.659 2.062v.19h.172v-.19zm0 .19a.172.172 0 0 1-.053.129l.121.121a.345.345 0 0 0 .1-.25zm-.053.129a.156.156 0 0 1-.118.042v.171a.327.327 0 0 0 .239-.092zm-.118.042h-3.858v.171h3.858zm-3.944.086v.1h.172v-.1zm0 .1a2.2 2.2 0 0 0 .453 1.287l.135-.106a2.027 2.027 0 0 1-.417-1.189zm.454 1.288a1.418 1.418 0 0 0 1.148.533v-.171a1.247 1.247 0 0 1-1.015-.47zm1.148.533a1.647 1.647 0 0 0 .882-.214l-.09-.146a1.481 1.481 0 0 1-.791.188zm.882-.214a1.777 1.777 0 0 0 .515-.458l-.14-.1a1.613 1.613 0 0 1-.466.412zm.513-.456a1.251 1.251 0 0 1 .081-.1.28.28 0 0 1 .026-.025l.008-.006-.077-.153a.326.326 0 0 0-.083.068 1.55 1.55 0 0 0-.092.113zm.12-.134a.328.328 0 0 1 .146-.021v-.171a.468.468 0 0 0-.234.046zm.146-.021h.547v-.171h-.547zm.547 0a.166.166 0 0 1 .112.036l.11-.132a.337.337 0 0 0-.222-.076zm.112.036a.107.107 0 0 1 .036.09h.171a.277.277 0 0 0-.1-.222zm.036.09a.9.9 0 0 1-.291.534l.128.115a1.055 1.055 0 0 0 .334-.649zm-.291.535a2.42 2.42 0 0 1-.83.581l.072.156a2.6 2.6 0 0 0 .888-.624zm-.829.58a2.964 2.964 0 0 1-1.224.238v.171a3.133 3.133 0 0 0 1.295-.253zm.389-3.111v-.033h-.171v.033zm0-.033a1.9 1.9 0 0 0-.445-1.306l-.129.114a1.731 1.731 0 0 1 .4 1.192zm-.444-1.3a1.466 1.466 0 0 0-1.181-.521v.172a1.3 1.3 0 0 1 1.049.46zm-1.181-.521a1.466 1.466 0 0 0-1.18.521l.131.11a1.3 1.3 0 0 1 1.049-.46zm-1.181.521a1.965 1.965 0 0 0-.422 1.3h.172a1.794 1.794 0 0 1 .382-1.194zm-.422 1.3v.033h.172v-.033zm.086.119h3.055v-.171h-3.055z" fill="#51504f" data-name="Path 10" transform="translate(-1460.636 -807.945)"></path>
                                <path id="Path_11" d="M1519.066 884.011a.581.581 0 0 1-.567-.567 1.151 1.151 0 0 1 .028-.312l7.026-18.328a.881.881 0 0 1 .906-.623h1.926a.882.882 0 0 1 .907.623l7 18.328.057.312a.583.583 0 0 1-.567.567h-1.445a.735.735 0 0 1-.482-.142.9.9 0 0 1-.226-.34l-1.558-4.023h-9.292l-1.558 4.023a.8.8 0 0 1-.255.34.688.688 0 0 1-.453.142zm12.181-6.94l-3.824-10.056-3.823 10.055zm8.184-10.538a.592.592 0 0 1-.652-.651v-1.53a.714.714 0 0 1 .17-.482.656.656 0 0 1 .482-.2h1.785a.677.677 0 0 1 .68.68v1.53a.655.655 0 0 1-.2.481.713.713 0 0 1-.481.17zm.227 17.479a.593.593 0 0 1-.652-.652v-13.428a.611.611 0 0 1 .17-.453.656.656 0 0 1 .482-.2h1.359a.679.679 0 0 1 .652.651v13.427a.655.655 0 0 1-.2.482.613.613 0 0 1-.453.17zm6.861 0a.592.592 0 0 1-.651-.652v-13.4a.715.715 0 0 1 .17-.481.656.656 0 0 1 .482-.2h1.3a.677.677 0 0 1 .68.68v1.246a4.255 4.255 0 0 1 3.966-1.926h1.1a.679.679 0 0 1 .651.651v1.161a.566.566 0 0 1-.2.453.612.612 0 0 1-.453.17h-1.7a3.2 3.2 0 0 0-2.408.907 3.253 3.253 0 0 0-.879 2.408v8.328a.656.656 0 0 1-.2.482.716.716 0 0 1-.482.17zm12.234 0a.593.593 0 0 1-.651-.652v-11.814h-2.408a.592.592 0 0 1-.651-.651v-.963a.611.611 0 0 1 .17-.453.654.654 0 0 1 .481-.2h2.408v-1.417q0-4.816 4.872-4.815h1.586a.679.679 0 0 1 .652.651v.963a.656.656 0 0 1-.2.481.613.613 0 0 1-.453.17h-1.529a2.1 2.1 0 0 0-1.785.68 3.248 3.248 0 0 0-.51 2.011v1.275h6.062V863.7a.613.613 0 0 1 .17-.453.656.656 0 0 1 .482-.2h1.3a.679.679 0 0 1 .652.651v19.659a.655.655 0 0 1-.2.482.613.613 0 0 1-.454.17h-1.3a.592.592 0 0 1-.652-.652v-11.811h-6.062v11.813a.657.657 0 0 1-.2.482.614.614 0 0 1-.454.17zm20.9.283a6.487 6.487 0 0 1-4.844-1.757 6.837 6.837 0 0 1-1.813-4.674l-.029-1.218.029-1.218a6.732 6.732 0 0 1 1.841-4.646 7.389 7.389 0 0 1 9.631 0 6.736 6.736 0 0 1 1.841 4.646q.028.311.028 1.218t-.028 1.218a6.772 6.772 0 0 1-1.841 4.674 6.391 6.391 0 0 1-4.82 1.756zm0-2.181a3.582 3.582 0 0 0 2.8-1.133 4.931 4.931 0 0 0 1.133-3.258q.028-.283.028-1.076t-.028-1.076a4.931 4.931 0 0 0-1.133-3.258 3.582 3.582 0 0 0-2.8-1.133 3.671 3.671 0 0 0-2.833 1.133 4.83 4.83 0 0 0-1.1 3.258l-.028 1.076.028 1.076a4.83 4.83 0 0 0 1.1 3.258 3.671 3.671 0 0 0 2.828 1.132zm13.755 1.9a.846.846 0 0 1-.566-.17 1.321 1.321 0 0 1-.34-.538l-4.023-13.144-.056-.283a.575.575 0 0 1 .17-.425.641.641 0 0 1 .425-.17h1.246a.612.612 0 0 1 .453.17.646.646 0 0 1 .255.312l3.145 10.679 3.371-10.566a.761.761 0 0 1 .255-.4.726.726 0 0 1 .538-.2h.963a.728.728 0 0 1 .539.2.76.76 0 0 1 .255.4l3.371 10.566 3.144-10.679a.655.655 0 0 1 .2-.312.714.714 0 0 1 .482-.17h1.275a.542.542 0 0 1 .4.17.576.576 0 0 1 .17.425l-.057.283-3.994 13.144a1.323 1.323 0 0 1-.34.538.9.9 0 0 1-.6.17h-1.1a.86.86 0 0 1-.935-.708l-3.286-10.141-3.286 10.141a.928.928 0 0 1-.963.708z" fill="#51504f" data-name="Path 11" transform="translate(-1454.66 -838.62)"></path>
                            </g>
                        </g>
                    </g>
                </svg>

            </a>
        </div>
        <div class="desktop-only navbar__menu-container">

            <div class="navbar__menu-content" id="main_navbar">

                <div class="navbar__links-container">
                    
                        <a class="navbar__text-link" href="/community/">
                            Community
                        </a>
                    
                        <a class="navbar__text-link" href="/meetups/">
                            Meetups
                        </a>
                    
                        <a class="navbar__text-link" href="/docs/">
                            Documentation
                        </a>
                    
                        <a class="navbar__text-link" href="/use-cases/">
                            Use-cases
                        </a>
                    
                        <a class="navbar__text-link" href="/announcements/">
                            Announcements
                        </a>
                    
                        <a class="navbar__text-link" href="/blog/">
                            Blog
                        </a>
                    
                        <a class="navbar__text-link" href="/ecosystem/">
                            Ecosystem
                        </a>
                    
                </div>

                

            </div>

        </div>
        <div class="mobile-only navbar__drawer-container">
            <button class="navbar__toggle-button" id="navbar-toggle-button">

                <div id="hamburger-icon" class="navbar__toggle-button--icon visible">
                    <svg xmlns="http://www.w3.org/2000/svg" width="26" height="20" viewBox="0 0 26 20">
                        <g id="Group_1294" data-name="Group 1294" transform="translate(-38.791 291)">
                            <g id="Group_1291" data-name="Group 1291" transform="translate(39 -291)">
                                <rect id="Rectangle_461" width="26" height="2" fill="#51504f" data-name="Rectangle 461" rx="1" transform="translate(-.209)"></rect>
                            </g>
                            <g id="Group_1292" data-name="Group 1292" transform="translate(39 -281.822)">
                                <rect id="Rectangle_462" width="26" height="2" fill="#51504f" data-name="Rectangle 462" rx="1" transform="translate(-.209 -.178)"></rect>
                            </g>
                            <g id="Group_1293" data-name="Group 1293" transform="translate(39 -272.644)">
                                <rect id="Rectangle_463" width="26" height="2" fill="#51504f" data-name="Rectangle 463" rx="1" transform="translate(-.209 -.356)"></rect>
                            </g>
                        </g>
                    </svg>

                </div>

                <div id="close-icon" class="navbar__toggle-button--icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="19.799" height="19.799" viewBox="0 0 19.799 19.799">
                        <g id="Group_1574" data-name="Group 1574" transform="translate(-41.892 290.899)">
                            <g id="Group_1291" data-name="Group 1291" transform="rotate(-45 -308.114 -187.077)">
                                <rect id="Rectangle_461" width="26" height="2" fill="#51504f" data-name="Rectangle 461" rx="1" transform="translate(-.209)"></rect>
                            </g>
                            <g id="Group_1292" data-name="Group 1292" transform="rotate(45 372.48 -93.011)">
                                <rect id="Rectangle_462" width="26" height="2" fill="#51504f" data-name="Rectangle 462" rx="1" transform="translate(-.209 -.178)"></rect>
                            </g>
                        </g>
                    </svg>

                </div>

            </button>
            <div class="navbar__drawer" id="navbar-drawer">
                <div class="navbar__menu-content" id="main_navbar">

                    <div class="navbar__links-container">
                        
                            <a class="navbar__text-link" href="/community/">
                                Community
                            </a>
                        
                            <a class="navbar__text-link" href="/meetups/">
                                Meetups
                            </a>
                        
                            <a class="navbar__text-link" href="/docs/">
                                Documentation
                            </a>
                        
                            <a class="navbar__text-link" href="/use-cases/">
                                Use-cases
                            </a>
                        
                            <a class="navbar__text-link" href="/announcements/">
                                Announcements
                            </a>
                        
                            <a class="navbar__text-link" href="/blog/">
                                Blog
                            </a>
                        
                            <a class="navbar__text-link" href="/ecosystem/">
                                Ecosystem
                            </a>
                        

                    </div>
                    

                </div>
            </div>
        </div>
    </nav>

</header>


    <div class="roadmap container-fluid td-default base-layout">
        
        
    <div class="content-drawer-wrapper">
        <button class="content-drawer__toggle-button" id="content-open-button">

            <div id="hamburger-icon" class="content-drawer__toggle-button--icon visible">
                <svg xmlns="http://www.w3.org/2000/svg" width="20.005" height="13.879" viewBox="0 0 20.005 13.879">
                    <g id="Group_1619" data-name="Group 1619" transform="translate(271.132 -418.872)">
                        <g id="Group_1613" data-name="Group 1613" transform="translate(-266.229 431.045)">
                            <path id="Path_1337" d="M-218.5 513.215h-14.583a.259.259 0 0 1-.259-.26.259.259 0 0 1 .259-.259h14.583a.26.26 0 0 1 .259.259.259.259 0 0 1-.259.26z" fill="#51504f" data-name="Path 1337" transform="translate(233.345 -512.696)"></path>
                        </g>
                        <g id="Group_1614" data-name="Group 1614" transform="translate(-266.229 425.684)">
                            <path id="Path_1338" d="M-218.5 471.9h-14.583a.259.259 0 0 1-.259-.26.26.26 0 0 1 .259-.259h14.583a.26.26 0 0 1 .259.259.26.26 0 0 1-.259.26z" fill="#51504f" data-name="Path 1338" transform="translate(233.345 -471.376)"></path>
                        </g>
                        <g id="Group_1615" data-name="Group 1615" transform="translate(-266.229 420.323)">
                            <path id="Path_1339" d="M-218.5 430.574h-14.583a.259.259 0 0 1-.259-.259.259.259 0 0 1 .259-.259h14.583a.26.26 0 0 1 .259.259.259.259 0 0 1-.259.259z" fill="#51504f" data-name="Path 1339" transform="translate(233.345 -430.055)"></path>
                        </g>
                        <g id="Group_1616" data-name="Group 1616" transform="translate(-271.132 429.814)">
                            <path id="Path_1340" d="M-269.663 506.145a1.47 1.47 0 0 1-1.469-1.469 1.47 1.47 0 0 1 1.469-1.469 1.47 1.47 0 0 1 1.469 1.469 1.47 1.47 0 0 1-1.469 1.469zm0-2.418a.951.951 0 0 0-.95.95.951.951 0 0 0 .95.95.951.951 0 0 0 .95-.95.951.951 0 0 0-.95-.95z" fill="#51504f" data-name="Path 1340" transform="translate(271.132 -503.208)"></path>
                        </g>
                        <g id="Group_1617" data-name="Group 1617" transform="translate(-271.132 424.556)">
                            <path id="Path_1341" d="M-269.663 465.62a1.47 1.47 0 0 1-1.469-1.469 1.47 1.47 0 0 1 1.469-1.469 1.47 1.47 0 0 1 1.469 1.469 1.47 1.47 0 0 1-1.469 1.469zm0-2.418a.951.951 0 0 0-.95.95.951.951 0 0 0 .95.95.951.951 0 0 0 .95-.95.951.951 0 0 0-.95-.952z" fill="#51504f" data-name="Path 1341" transform="translate(271.132 -462.683)"></path>
                        </g>
                        <g id="Group_1618" data-name="Group 1618" transform="translate(-271.132 418.872)">
                            <path id="Path_1342" d="M-269.663 421.809a1.47 1.47 0 0 1-1.469-1.469 1.47 1.47 0 0 1 1.469-1.469 1.47 1.47 0 0 1 1.469 1.469 1.47 1.47 0 0 1-1.469 1.469zm0-2.418a.951.951 0 0 0-.95.95.951.951 0 0 0 .95.95.951.951 0 0 0 .95-.95.951.951 0 0 0-.95-.95z" fill="#51504f" data-name="Path 1342" transform="translate(271.132 -418.872)"></path>
                        </g>
                    </g>
                </svg>

                <span class="bodytext__mobile--brownish-grey">Content</span>
            </div>

        </button>
        <nav id="content-navbar" class="navbar navbar--hidden">
            <div class="navbar__icon-container">
                <a href="/">
                    <svg xmlns="http://www.w3.org/2000/svg" width="155.314" height="60" viewBox="0 0 155.314 60">
                        <defs>
                            <clipPath id="clip-path">
                                <path id="Rectangle_1" d="M0 0h155.314v60H0z" fill="none" data-name="Rectangle 1"></path>
                            </clipPath>
                        </defs>
                        <g id="logo" transform="translate(-1305 -780.355)">
                            <g id="Group_2" clip-path="url(#clip-path)" data-name="Group 2" transform="translate(1305 780.355)">
                                <g id="Group_1" data-name="Group 1" transform="translate(.486 .486)">
                                    <path id="Path_1" d="M1307.562 880.867l28.187-28.893a.521.521 0 0 0 .063-.666c-1.714-2.393-4.877-2.808-6.049-4.416-3.472-4.763-4.353-7.459-5.845-7.292a.456.456 0 0 0-.271.143l-10.182 10.438c-5.858 6-6.7 19.225-6.852 30.3a.552.552 0 0 0 .949.386z" fill="#017cee" data-name="Path 1" transform="translate(-1306.613 -822.232)"></path>
                                    <path id="Path_2" d="M1405.512 908.489l-28.893-28.189a.521.521 0 0 0-.667-.063c-2.393 1.715-2.808 4.877-4.416 6.049-4.763 3.472-7.459 4.353-7.292 5.845a.456.456 0 0 0 .143.27l10.438 10.182c6 5.858 19.225 6.7 30.3 6.852a.552.552 0 0 0 .387-.946z" fill="#00ad46" data-name="Path 2" transform="translate(-1346.876 -850.567)"></path>
                                    <path id="Path_3" d="M1373.909 902.252c-3.28-3.2-4.8-9.53 1.486-22.583-10.219 4.567-13.8 10.57-12.039 12.289z" fill="#04d659" data-name="Path 3" transform="translate(-1345.96 -850.233)"></path>
                                    <path id="Path_4" d="M1433.132 782.359l-28.186 28.893a.52.52 0 0 0-.063.666c1.715 2.393 4.876 2.808 6.049 4.416 3.472 4.763 4.354 7.459 5.845 7.292a.454.454 0 0 0 .271-.143l10.182-10.438c5.858-6 6.7-19.225 6.852-30.3a.553.553 0 0 0-.95-.386z" fill="#00c7d4" data-name="Path 4" transform="translate(-1375.21 -782.123)"></path>
                                    <path id="Path_5" d="M1426.9 881.155c-3.2 3.28-9.53 4.8-22.584-1.486 4.567 10.219 10.57 13.8 12.289 12.039z" fill="#11e1ee" data-name="Path 5" transform="translate(-1374.875 -850.233)"></path>
                                    <path id="Path_6" d="M1307 782.919l28.893 28.186a.521.521 0 0 0 .666.063c2.393-1.715 2.808-4.877 4.416-6.049 4.763-3.472 7.459-4.353 7.292-5.845a.459.459 0 0 0-.143-.271l-10.438-10.182c-6-5.858-19.225-6.7-30.3-6.852a.552.552 0 0 0-.386.95z" fill="#e43921" data-name="Path 6" transform="translate(-1306.766 -781.97)"></path>
                                    <path id="Path_7" d="M1405.8 804.711c3.28 3.2 4.8 9.53-1.486 22.584 10.219-4.567 13.8-10.571 12.039-12.289z" fill-rule="evenodd" fill="#ff7557" data-name="Path 7" transform="translate(-1374.875 -797.859)"></path>
                                    <path id="Path_8" d="M1329.355 849.266c3.2-3.28 9.53-4.8 22.584 1.486-4.567-10.219-10.57-13.8-12.289-12.039z" fill="#0cb6ff" data-name="Path 8" transform="translate(-1322.503 -821.316)"></path>
                                    <circle id="Ellipse_1" cx="1.26" cy="1.26" r="1.26" fill="#4a4848" data-name="Ellipse 1" transform="translate(28.18 28.171)"></circle>
                                    <path id="Path_9" d="M1527.558 827.347a.229.229 0 0 1-.223-.223.458.458 0 0 1 .011-.123l2.766-7.214a.346.346 0 0 1 .357-.245h.758a.348.348 0 0 1 .357.245l2.754 7.214.022.123a.228.228 0 0 1-.223.223h-.568a.288.288 0 0 1-.19-.056.352.352 0 0 1-.089-.134l-.613-1.583h-3.657l-.613 1.583a.317.317 0 0 1-.1.134.269.269 0 0 1-.178.056zm4.795-2.732l-1.505-3.958-1.505 3.958zm3.322 4.85a.258.258 0 0 1-.189-.078.241.241 0 0 1-.067-.178v-7.4a.241.241 0 0 1 .067-.178.258.258 0 0 1 .189-.078h.513a.268.268 0 0 1 .256.256v.49a2.118 2.118 0 0 1 1.828-.858 2.092 2.092 0 0 1 1.751.736 3.135 3.135 0 0 1 .636 1.9q.011.122.011.379t-.011.379a3.168 3.168 0 0 1-.636 1.9 2.111 2.111 0 0 1-1.751.736 2.154 2.154 0 0 1-1.806-.836v2.587a.241.241 0 0 1-.067.178.223.223 0 0 1-.179.078zm2.364-2.91a1.324 1.324 0 0 0 1.149-.491 2.266 2.266 0 0 0 .4-1.293q.011-.111.011-.323 0-2.107-1.562-2.107a1.365 1.365 0 0 0-1.159.513 2.111 2.111 0 0 0-.412 1.2l-.012.424.012.435a1.862 1.862 0 0 0 .424 1.149 1.4 1.4 0 0 0 1.148.493zm5.628.9a2.329 2.329 0 0 1-1.015-.223 1.94 1.94 0 0 1-.747-.6 1.487 1.487 0 0 1-.268-.859 1.459 1.459 0 0 1 .6-1.2 3.4 3.4 0 0 1 1.65-.624l1.661-.234v-.323q0-1.137-1.3-1.137a1.4 1.4 0 0 0-.8.212 1.376 1.376 0 0 0-.468.48.305.305 0 0 1-.089.145.18.18 0 0 1-.134.045h-.48a.23.23 0 0 1-.245-.245 1.17 1.17 0 0 1 .245-.6 1.931 1.931 0 0 1 .747-.591 2.7 2.7 0 0 1 1.238-.256 2.351 2.351 0 0 1 1.8.591 2.032 2.032 0 0 1 .547 1.45v3.613a.257.257 0 0 1-.078.19.24.24 0 0 1-.178.067h-.513a.233.233 0 0 1-.257-.256v-.479a1.923 1.923 0 0 1-.714.6 2.557 2.557 0 0 1-1.203.237zm.234-.836a1.579 1.579 0 0 0 1.182-.469 1.881 1.881 0 0 0 .468-1.371v-.312l-1.293.19a2.918 2.918 0 0 0-1.193.379.761.761 0 0 0-.4.658.784.784 0 0 0 .368.691 1.585 1.585 0 0 0 .867.237zm6.643.836a2.556 2.556 0 0 1-1.873-.669 2.738 2.738 0 0 1-.714-1.9l-.011-.446.011-.446a2.7 2.7 0 0 1 .714-1.885 2.531 2.531 0 0 1 1.873-.68 2.917 2.917 0 0 1 1.36.29 2.077 2.077 0 0 1 .825.714 1.7 1.7 0 0 1 .3.848.2.2 0 0 1-.067.178.281.281 0 0 1-.19.067h-.535a.265.265 0 0 1-.168-.045.458.458 0 0 1-.111-.178 1.428 1.428 0 0 0-.535-.758 1.516 1.516 0 0 0-.87-.234 1.45 1.45 0 0 0-1.1.435 1.952 1.952 0 0 0-.435 1.3l-.011.4.011.379a1.969 1.969 0 0 0 .435 1.316 1.446 1.446 0 0 0 1.1.424 1.577 1.577 0 0 0 .87-.223 1.493 1.493 0 0 0 .535-.769.458.458 0 0 1 .111-.178.228.228 0 0 1 .168-.056h.535a.258.258 0 0 1 .19.078.2.2 0 0 1 .067.178 1.75 1.75 0 0 1-.3.847 2.078 2.078 0 0 1-.825.714 2.876 2.876 0 0 1-1.361.302zm4.078-.112a.233.233 0 0 1-.257-.256v-7.4a.241.241 0 0 1 .067-.178.259.259 0 0 1 .19-.078h.557a.267.267 0 0 1 .257.256v2.6a2.167 2.167 0 0 1 .758-.624 2.353 2.353 0 0 1 1.082-.223 2.067 2.067 0 0 1 1.661.691 2.642 2.642 0 0 1 .6 1.818v3.144a.257.257 0 0 1-.078.19.24.24 0 0 1-.178.067h-.557a.233.233 0 0 1-.256-.256V824a1.775 1.775 0 0 0-.39-1.227 1.387 1.387 0 0 0-1.1-.435 1.481 1.481 0 0 0-1.126.446 1.7 1.7 0 0 0-.412 1.215v3.088a.257.257 0 0 1-.078.19.24.24 0 0 1-.178.067zm8.846.112a2.466 2.466 0 0 1-1.84-.7 2.938 2.938 0 0 1-.747-1.94l-.011-.379.011-.368a2.953 2.953 0 0 1 .758-1.918 2.7 2.7 0 0 1 3.735.078 3.114 3.114 0 0 1 .68 2.119v.19a.257.257 0 0 1-.078.189.241.241 0 0 1-.178.067h-3.858v.1a2.11 2.11 0 0 0 .435 1.238 1.332 1.332 0 0 0 1.081.5 1.563 1.563 0 0 0 .836-.2 1.7 1.7 0 0 0 .491-.435.6.6 0 0 1 .145-.156.391.391 0 0 1 .19-.033h.547a.252.252 0 0 1 .167.056.192.192 0 0 1 .067.156.975.975 0 0 1-.312.591 2.51 2.51 0 0 1-.859.6 3.049 3.049 0 0 1-1.26.248zm1.527-3.434v-.033a1.817 1.817 0 0 0-.424-1.249 1.512 1.512 0 0 0-2.23 0 1.883 1.883 0 0 0-.4 1.249v.033z" fill="#51504f" data-name="Path 9" transform="translate(-1460.834 -808.144)"></path>
                                    <path id="Path_10" d="M1527.2 827.081l-.061.061zm-.056-.279l-.08-.031zm2.766-7.214l.08.031zm1.472 0l-.081.029zm2.754 7.214l.084-.015a.064.064 0 0 0 0-.015zm.022.123h.086v-.015zm-.067.156l.06.061zm-.914.011l-.061.061.006.005zm-.089-.134l.081-.027zm-.613-1.583l.08-.031a.086.086 0 0 0-.08-.055zm-3.657 0v-.086a.086.086 0 0 0-.08.055zm-.613 1.583l-.08-.031zm-.1.134l.055.066zm4.047-2.676v.086a.086.086 0 0 0 .08-.116zm-1.505-3.958l.08-.03a.086.086 0 0 0-.16 0zm-1.505 3.958l-.08-.03a.086.086 0 0 0 .08.116zm-1.784 2.646a.128.128 0 0 1-.1-.042l-.122.121a.3.3 0 0 0 .217.092zm-.1-.042a.129.129 0 0 1-.042-.1h-.171a.3.3 0 0 0 .092.217zm-.042-.1a.38.38 0 0 1 .007-.1l-.163-.054a.514.514 0 0 0-.016.15zm.005-.092l2.765-7.214-.16-.061-2.765 7.214zm2.766-7.216a.283.283 0 0 1 .1-.143.3.3 0 0 1 .174-.046v-.172a.47.47 0 0 0-.271.076.453.453 0 0 0-.166.226zm.276-.189h.758v-.172h-.758zm.758 0a.3.3 0 0 1 .175.046.283.283 0 0 1 .1.143l.161-.059a.451.451 0 0 0-.166-.226.47.47 0 0 0-.272-.076zm.277.19l2.754 7.214.16-.061-2.754-7.214zm2.75 7.2l.022.123.169-.031-.022-.123zm.021.107a.13.13 0 0 1-.042.1l.121.121a.3.3 0 0 0 .092-.217zm-.042.1a.13.13 0 0 1-.1.042v.171a.3.3 0 0 0 .217-.092zm-.1.042h-.568v.171h.568zm-.568 0a.206.206 0 0 1-.135-.036l-.11.132a.373.373 0 0 0 .245.076zm-.129-.031a.262.262 0 0 1-.069-.1l-.162.054a.431.431 0 0 0 .11.167zm-.07-.1l-.613-1.584-.16.062.613 1.583zm-.693-1.638h-3.657v.171h3.657zm-3.737.055l-.614 1.584.16.062.613-1.583zm-.615 1.587a.235.235 0 0 1-.075.1l.111.13a.4.4 0 0 0 .126-.172zm-.074.1a.185.185 0 0 1-.124.036v.171a.354.354 0 0 0 .233-.076zm-.124.036h-.569v.171h.569zm4.306-2.677l-1.505-3.958-.16.061 1.505 3.958zm-1.666-3.958l-1.505 3.958.16.061 1.505-3.958zm-1.425 4.075h3.01v-.171h-3.01zm6.143 4.687l-.06.061zm0-7.761l.061.061zm.881 0l-.065.056.01.009zm.078.669h-.086a.086.086 0 0 0 .155.051zm3.579-.123l-.067.053zm.636 1.9h-.086zm0 .758l-.085-.007zm-.636 1.9l.067.054zm-3.557-.1l.068-.052a.086.086 0 0 0-.154.052zm-.067 2.765l-.061-.06zm2.787-3.323l-.069-.051zm.4-1.293l-.085-.008v.005zm-2.709-1.918l-.068-.052zm-.413 1.2h-.086zm-.011.423h-.085zm.011.435h-.086zm.424 1.149l.066-.054zm-1.216 3.315a.173.173 0 0 1-.129-.053l-.121.121a.342.342 0 0 0 .25.1zm-.129-.053a.157.157 0 0 1-.042-.118h-.172a.325.325 0 0 0 .092.239zm-.042-.118v-7.4h-.172v7.4zm0-7.4a.157.157 0 0 1 .042-.118l-.121-.121a.324.324 0 0 0-.092.239zm.042-.118a.173.173 0 0 1 .129-.053v-.172a.342.342 0 0 0-.25.1zm.129-.053h.513v-.172h-.513zm.513 0a.137.137 0 0 1 .113.048l.13-.111a.309.309 0 0 0-.244-.108zm.123.058a.137.137 0 0 1 .048.113h.171a.309.309 0 0 0-.108-.243zm.048.113v.49h.171v-.49zm.155.541a2.033 2.033 0 0 1 1.759-.823v-.171a2.2 2.2 0 0 0-1.9.894zm1.759-.823a2.007 2.007 0 0 1 1.683.7l.135-.106a2.177 2.177 0 0 0-1.818-.768zm1.683.7a3.045 3.045 0 0 1 .617 1.845l.171-.007a3.218 3.218 0 0 0-.654-1.946zm.617 1.85c.007.078.011.2.011.372h.171c0-.171 0-.3-.012-.387zm.011.372c0 .171 0 .294-.011.372l.17.015c.008-.086.012-.216.012-.387zm-.011.376a3.08 3.08 0 0 1-.617 1.846l.134.106a3.25 3.25 0 0 0 .654-1.945zm-.617 1.845a2.025 2.025 0 0 1-1.683.7v.171a2.2 2.2 0 0 0 1.817-.768zm-1.683.7a2.068 2.068 0 0 1-1.739-.8l-.136.1a2.239 2.239 0 0 0 1.874.87zm-1.892-.75v2.587h.172v-2.587zm0 2.587a.156.156 0 0 1-.042.118l.121.121a.325.325 0 0 0 .092-.239zm-.046.123a.138.138 0 0 1-.114.048v.172a.308.308 0 0 0 .244-.108zm-.114.048h-.546v.172h.546zm1.817-2.739a1.408 1.408 0 0 0 1.218-.526l-.138-.1a1.24 1.24 0 0 1-1.079.455zm1.217-.525a2.355 2.355 0 0 0 .419-1.341l-.171-.007a2.182 2.182 0 0 1-.385 1.246zm.418-1.336c.008-.079.012-.19.012-.332h-.172c0 .14 0 .245-.011.315zm.012-.332a2.726 2.726 0 0 0-.407-1.632 1.448 1.448 0 0 0-1.24-.562v.171a1.278 1.278 0 0 1 1.1.492 2.565 2.565 0 0 1 .374 1.53zm-1.647-2.193a1.452 1.452 0 0 0-1.228.547l.136.1a1.282 1.282 0 0 1 1.091-.479zm-1.228.547a2.2 2.2 0 0 0-.43 1.252l.172.008a2.028 2.028 0 0 1 .4-1.157zm-.43 1.254l-.011.424h.171l.011-.424zm-.011.428l.011.435h.172l-.011-.435zm.011.436a1.95 1.95 0 0 0 .443 1.2l.133-.109a1.776 1.776 0 0 1-.4-1.1zm.443 1.2a1.484 1.484 0 0 0 1.214.522v-.171a1.314 1.314 0 0 1-1.082-.459zm5.828 1.117l.037-.077zm-.747-.6l-.07.049zm.335-2.063l.052.068zm1.65-.624l.012.085zm1.661-.234l.012.085a.086.086 0 0 0 .074-.085zm-2.107-1.249l.046.072zm-.468.48l-.075-.042a.083.083 0 0 0-.006.015zm-.089.145l-.054-.067-.007.006zm-.792-.022l-.065.056.009.009zm-.067-.178h-.086zm.245-.6l-.07-.049zm.747-.591l.038.077zm3.033.334l-.063.058zm.468 5.252l.06.061zm-.881 0l-.065.056a.043.043 0 0 0 .009.009zm-.067-.669h.086a.086.086 0 0 0-.156-.048zm-.714.6l-.04-.076zm.223-1.059l-.062-.06zm.468-1.684h.086a.086.086 0 0 0-.1-.085zm-1.293.189l.012.085zm-1.193.379l.046.072zm-.033 1.349l-.047.071zm.635.985a2.241 2.241 0 0 1-.978-.215l-.074.155a2.412 2.412 0 0 0 1.051.231zm-.978-.215a1.859 1.859 0 0 1-.715-.576l-.138.1a2.024 2.024 0 0 0 .779.629zm-.713-.573a1.4 1.4 0 0 1-.253-.81h-.172a1.571 1.571 0 0 0 .283.907zm-.253-.81a1.374 1.374 0 0 1 .569-1.136l-.105-.135a1.544 1.544 0 0 0-.635 1.272zm.569-1.137a3.316 3.316 0 0 1 1.609-.607l-.024-.17a3.481 3.481 0 0 0-1.691.642zm1.609-.607l1.661-.234-.024-.17-1.662.234zm1.735-.319v-.323h-.171v.323zm0-.323a1.156 1.156 0 0 0-.355-.917 1.536 1.536 0 0 0-1.035-.306v.172a1.37 1.37 0 0 1 .922.263.986.986 0 0 1 .3.788zm-1.39-1.223a1.486 1.486 0 0 0-.851.227l.1.142a1.316 1.316 0 0 1 .755-.2zm-.849.226a1.452 1.452 0 0 0-.5.51l.15.084a1.286 1.286 0 0 1 .44-.449zm-.5.524a.226.226 0 0 1-.062.105l.107.134a.391.391 0 0 0 .117-.185zm-.068.112a.1.1 0 0 1-.073.019v.171a.266.266 0 0 0 .194-.07zm-.073.019h-.48v.171h.48zm-.48 0a.18.18 0 0 1-.122-.046l-.112.13a.352.352 0 0 0 .234.087zm-.113-.037a.18.18 0 0 1-.047-.123h-.171a.352.352 0 0 0 .087.234zm-.047-.119a1.1 1.1 0 0 1 .23-.557l-.14-.1a1.253 1.253 0 0 0-.261.648zm.23-.556a1.843 1.843 0 0 1 .715-.564l-.075-.154a2.018 2.018 0 0 0-.78.618zm.716-.564a2.611 2.611 0 0 1 1.2-.247v-.171a2.781 2.781 0 0 0-1.277.266zm1.2-.247a2.268 2.268 0 0 1 1.732.563l.126-.116a2.435 2.435 0 0 0-1.858-.618zm1.733.564a1.945 1.945 0 0 1 .523 1.391h.171a2.117 2.117 0 0 0-.57-1.508zm.523 1.391v3.613h.171v-3.613zm0 3.613a.172.172 0 0 1-.053.129l.121.121a.344.344 0 0 0 .1-.25zm-.053.129a.157.157 0 0 1-.118.042v.171a.326.326 0 0 0 .239-.092zm-.118.042h-.513v.171h.513zm-.513 0a.2.2 0 0 1-.134-.046l-.111.13a.367.367 0 0 0 .245.088zm-.124-.037a.194.194 0 0 1-.047-.134h-.171a.366.366 0 0 0 .087.245zm-.047-.134v-.479h-.171v.479zm-.156-.528a1.846 1.846 0 0 1-.683.575l.079.152a2.012 2.012 0 0 0 .745-.629zm-.683.575a2.476 2.476 0 0 1-1.153.236v.171a2.644 2.644 0 0 0 1.233-.255zm-.919-.429a1.666 1.666 0 0 0 1.244-.494l-.123-.12a1.493 1.493 0 0 1-1.121.442zm1.244-.494a1.969 1.969 0 0 0 .492-1.431h-.171a1.8 1.8 0 0 1-.444 1.312zm.492-1.431v-.312h-.171v.312zm-.1-.4l-1.293.189.025.17 1.293-.189zm-1.293.189a3 3 0 0 0-1.228.393l.095.143a2.837 2.837 0 0 1 1.158-.365zm-1.227.392a.845.845 0 0 0-.441.73h.172a.676.676 0 0 1 .362-.586zm-.441.73a.869.869 0 0 0 .406.762l.095-.142a.7.7 0 0 1-.33-.62zm.408.764a1.673 1.673 0 0 0 .916.247v-.171a1.5 1.5 0 0 1-.823-.221zm5.686.329l-.061.06zm-.714-1.9h-.085zm-.011-.446h-.085zm.011-.446h-.085zm.714-1.885l.061.061zm3.234-.39l-.04.076zm.825.713l-.073.046zm.3.848h-.086zm-.067.178l.056.065zm-.892.022l.054-.067zm-.112-.178l-.081.029zm-.535-.758l-.048.071zm-1.974.2l-.062-.059zm-.435 1.3h-.086zm-.011.4h-.086zm.011.379h-.086zm.435 1.316l-.062.059zm1.974.2l.046.072zm.535-.769l-.079-.033zm.112-.178l.054.067.007-.006zm.892.022l-.061.06zm.067.178l-.085-.009zm-.3.847l-.072-.046zm-.825.714l-.04-.076zm-1.36.2a2.471 2.471 0 0 1-1.814-.644l-.12.122a2.64 2.64 0 0 0 1.933.694zm-1.813-.643a2.653 2.653 0 0 1-.689-1.839l-.171.006a2.822 2.822 0 0 0 .738 1.952zm-.689-1.838l-.011-.446h-.171l.011.446zm-.011-.442l.011-.446h-.171l-.011.446zm.011-.445a2.611 2.611 0 0 1 .689-1.827l-.122-.121a2.78 2.78 0 0 0-.738 1.942zm.689-1.827a2.447 2.447 0 0 1 1.813-.655v-.171a2.617 2.617 0 0 0-1.934.705zm1.813-.655a2.836 2.836 0 0 1 1.32.28l.079-.152a3 3 0 0 0-1.4-.3zm1.32.28a1.99 1.99 0 0 1 .792.683l.145-.091a2.158 2.158 0 0 0-.858-.744zm.793.685a1.617 1.617 0 0 1 .287.8l.171-.009a1.789 1.789 0 0 0-.315-.89zm.287.809a.11.11 0 0 1-.037.1l.112.13a.281.281 0 0 0 .1-.252zm-.037.1a.2.2 0 0 1-.134.046v.171a.369.369 0 0 0 .246-.088zm-.134.046h-.535v.171h.535zm-.535 0a.184.184 0 0 1-.114-.026l-.107.134a.345.345 0 0 0 .221.064zm-.114-.026a.389.389 0 0 1-.086-.144l-.158.066a.533.533 0 0 0 .137.212zm-.084-.14a1.514 1.514 0 0 0-.57-.8l-.093.144a1.343 1.343 0 0 1 .5.715zm-.568-.8a1.6 1.6 0 0 0-.918-.249v.171a1.435 1.435 0 0 1 .822.219zm-.918-.249a1.535 1.535 0 0 0-1.166.462l.124.118a1.364 1.364 0 0 1 1.042-.408zm-1.166.462a2.036 2.036 0 0 0-.458 1.36l.171.006a1.872 1.872 0 0 1 .411-1.249zm-.458 1.361l-.011.4h.171l.011-.4zm-.011.406l.011.379.171-.005-.011-.379zm.011.38a2.052 2.052 0 0 0 .458 1.371l.124-.118a1.889 1.889 0 0 1-.411-1.26zm.458 1.371a1.533 1.533 0 0 0 1.166.451v-.172a1.363 1.363 0 0 1-1.042-.4zm1.166.451a1.661 1.661 0 0 0 .916-.237l-.093-.144a1.491 1.491 0 0 1-.823.209zm.918-.238a1.576 1.576 0 0 0 .568-.812l-.162-.057a1.409 1.409 0 0 1-.5.727zm.566-.807a.39.39 0 0 1 .086-.144l-.107-.134a.533.533 0 0 0-.137.213zm.093-.151a.144.144 0 0 1 .107-.031v-.171a.31.31 0 0 0-.228.081zm.107-.031h.535v-.171h-.535zm.535 0a.173.173 0 0 1 .129.053l.121-.121a.344.344 0 0 0-.25-.1zm.134.057a.11.11 0 0 1 .037.1l.17.017a.281.281 0 0 0-.1-.252zm.037.109a1.664 1.664 0 0 1-.288.806l.144.092a1.839 1.839 0 0 0 .315-.889zm-.288.806a1.989 1.989 0 0 1-.792.683l.079.152a2.162 2.162 0 0 0 .858-.744zm-.793.684a2.8 2.8 0 0 1-1.32.28v.171a2.96 2.96 0 0 0 1.4-.3zm2.568.187l-.065.056.01.009zm0-7.772l.061.06zm.926 0l-.065.056.009.009zm.078 2.776h-.085a.086.086 0 0 0 .153.053zm.758-.624l.038.077zm2.743.468l-.065.056zm.524 5.151l-.061-.06zm-.925 0l-.065.056.009.009zm-.457-4.5l-.065.056zm-2.23.011l-.062-.059zm-.49 4.493l-.061-.06zm-.736-.019a.2.2 0 0 1-.134-.046l-.112.13a.367.367 0 0 0 .245.088zm-.124-.037a.2.2 0 0 1-.046-.134h-.172a.367.367 0 0 0 .087.245zm-.046-.134v-7.4h-.172v7.4zm0-7.4a.156.156 0 0 1 .042-.118l-.121-.121a.326.326 0 0 0-.092.239zm.042-.118a.172.172 0 0 1 .129-.053v-.171a.343.343 0 0 0-.25.1zm.129-.053h.557v-.171h-.557zm.557 0a.137.137 0 0 1 .113.048l.13-.112a.308.308 0 0 0-.244-.108zm.122.057a.137.137 0 0 1 .048.113h.172a.309.309 0 0 0-.108-.243zm.048.113v2.6h.172v-2.6zm.153 2.651a2.076 2.076 0 0 1 .728-.6l-.075-.154a2.248 2.248 0 0 0-.788.649zm.73-.6a2.272 2.272 0 0 1 1.043-.214v-.171a2.438 2.438 0 0 0-1.121.232zm1.043-.214a1.982 1.982 0 0 1 1.6.661l.13-.112a2.152 2.152 0 0 0-1.727-.721zm1.6.663a2.557 2.557 0 0 1 .581 1.761h.171a2.727 2.727 0 0 0-.624-1.874zm.581 1.761v3.144h.171v-3.144zm0 3.144a.173.173 0 0 1-.053.129l.121.121a.345.345 0 0 0 .1-.25zm-.053.129a.156.156 0 0 1-.118.042v.171a.327.327 0 0 0 .239-.092zm-.118.042h-.557v.171h.557zm-.557 0a.2.2 0 0 1-.134-.046l-.112.13a.367.367 0 0 0 .245.088zm-.124-.037a.2.2 0 0 1-.046-.134h-.172a.368.368 0 0 0 .087.245zm-.046-.134V823.8h-.172v3.088zm0-3.088a1.859 1.859 0 0 0-.412-1.284l-.128.114a1.69 1.69 0 0 1 .368 1.169zm-.411-1.283a1.471 1.471 0 0 0-1.169-.464v.171a1.3 1.3 0 0 1 1.039.406zm-1.169-.464a1.566 1.566 0 0 0-1.188.473l.124.118a1.4 1.4 0 0 1 1.064-.419zm-1.188.473a1.779 1.779 0 0 0-.436 1.275h.172a1.609 1.609 0 0 1 .389-1.156zm-.436 1.275v3.088h.172V823.8zm0 3.088a.172.172 0 0 1-.053.129l.121.121a.344.344 0 0 0 .1-.25zm-.053.129a.156.156 0 0 1-.118.042v.171a.327.327 0 0 0 .239-.092zm-.118.042h-.557v.171h.557zm6.449-.505l-.062.059zm-.747-1.94h-.086zm-.012-.379h-.085v.005zm.012-.368l-.086-.006zm.758-1.918l-.061-.06zm3.735.078l-.065.056zm.6 2.5l.061.061zm-4.036.067v-.086a.086.086 0 0 0-.086.086zm0 .1h-.086zm.435 1.238l-.068.053zm1.918.3l.045.073zm.491-.435l-.069-.051zm.145-.156l.039.077h.006zm.9.022l-.055.066zm-.245.747l-.064-.057zm-.858.6l.035.078zm.267-3.189v.086a.086.086 0 0 0 .086-.086zm-.424-1.282l-.066.055zm-2.23 0l-.065-.055zm-.4 1.282h-.086a.086.086 0 0 0 .086.086zm1.528 3.349a2.38 2.38 0 0 1-1.779-.677l-.122.12a2.55 2.55 0 0 0 1.9.728zm-1.778-.676a2.86 2.86 0 0 1-.724-1.886l-.171.009a3.027 3.027 0 0 0 .771 1.995zm-.723-1.884l-.011-.379h-.171l.011.379zm-.011-.374l.011-.368-.172-.005-.011.368zm.011-.365a2.871 2.871 0 0 1 .735-1.864l-.124-.118a3.042 3.042 0 0 0-.782 1.971zm.734-1.864a2.331 2.331 0 0 1 1.756-.687v-.171a2.5 2.5 0 0 0-1.879.74zm1.756-.687a2.307 2.307 0 0 1 1.853.762l.13-.112a2.477 2.477 0 0 0-1.983-.821zm1.854.762a3.03 3.03 0 0 1 .659 2.062h.172a3.2 3.2 0 0 0-.7-2.175zm.659 2.062v.19h.172v-.19zm0 .19a.172.172 0 0 1-.053.129l.121.121a.345.345 0 0 0 .1-.25zm-.053.129a.156.156 0 0 1-.118.042v.171a.327.327 0 0 0 .239-.092zm-.118.042h-3.858v.171h3.858zm-3.944.086v.1h.172v-.1zm0 .1a2.2 2.2 0 0 0 .453 1.287l.135-.106a2.027 2.027 0 0 1-.417-1.189zm.454 1.288a1.418 1.418 0 0 0 1.148.533v-.171a1.247 1.247 0 0 1-1.015-.47zm1.148.533a1.647 1.647 0 0 0 .882-.214l-.09-.146a1.481 1.481 0 0 1-.791.188zm.882-.214a1.777 1.777 0 0 0 .515-.458l-.14-.1a1.613 1.613 0 0 1-.466.412zm.513-.456a1.251 1.251 0 0 1 .081-.1.28.28 0 0 1 .026-.025l.008-.006-.077-.153a.326.326 0 0 0-.083.068 1.55 1.55 0 0 0-.092.113zm.12-.134a.328.328 0 0 1 .146-.021v-.171a.468.468 0 0 0-.234.046zm.146-.021h.547v-.171h-.547zm.547 0a.166.166 0 0 1 .112.036l.11-.132a.337.337 0 0 0-.222-.076zm.112.036a.107.107 0 0 1 .036.09h.171a.277.277 0 0 0-.1-.222zm.036.09a.9.9 0 0 1-.291.534l.128.115a1.055 1.055 0 0 0 .334-.649zm-.291.535a2.42 2.42 0 0 1-.83.581l.072.156a2.6 2.6 0 0 0 .888-.624zm-.829.58a2.964 2.964 0 0 1-1.224.238v.171a3.133 3.133 0 0 0 1.295-.253zm.389-3.111v-.033h-.171v.033zm0-.033a1.9 1.9 0 0 0-.445-1.306l-.129.114a1.731 1.731 0 0 1 .4 1.192zm-.444-1.3a1.466 1.466 0 0 0-1.181-.521v.172a1.3 1.3 0 0 1 1.049.46zm-1.181-.521a1.466 1.466 0 0 0-1.18.521l.131.11a1.3 1.3 0 0 1 1.049-.46zm-1.181.521a1.965 1.965 0 0 0-.422 1.3h.172a1.794 1.794 0 0 1 .382-1.194zm-.422 1.3v.033h.172v-.033zm.086.119h3.055v-.171h-3.055z" fill="#51504f" data-name="Path 10" transform="translate(-1460.636 -807.945)"></path>
                                    <path id="Path_11" d="M1519.066 884.011a.581.581 0 0 1-.567-.567 1.151 1.151 0 0 1 .028-.312l7.026-18.328a.881.881 0 0 1 .906-.623h1.926a.882.882 0 0 1 .907.623l7 18.328.057.312a.583.583 0 0 1-.567.567h-1.445a.735.735 0 0 1-.482-.142.9.9 0 0 1-.226-.34l-1.558-4.023h-9.292l-1.558 4.023a.8.8 0 0 1-.255.34.688.688 0 0 1-.453.142zm12.181-6.94l-3.824-10.056-3.823 10.055zm8.184-10.538a.592.592 0 0 1-.652-.651v-1.53a.714.714 0 0 1 .17-.482.656.656 0 0 1 .482-.2h1.785a.677.677 0 0 1 .68.68v1.53a.655.655 0 0 1-.2.481.713.713 0 0 1-.481.17zm.227 17.479a.593.593 0 0 1-.652-.652v-13.428a.611.611 0 0 1 .17-.453.656.656 0 0 1 .482-.2h1.359a.679.679 0 0 1 .652.651v13.427a.655.655 0 0 1-.2.482.613.613 0 0 1-.453.17zm6.861 0a.592.592 0 0 1-.651-.652v-13.4a.715.715 0 0 1 .17-.481.656.656 0 0 1 .482-.2h1.3a.677.677 0 0 1 .68.68v1.246a4.255 4.255 0 0 1 3.966-1.926h1.1a.679.679 0 0 1 .651.651v1.161a.566.566 0 0 1-.2.453.612.612 0 0 1-.453.17h-1.7a3.2 3.2 0 0 0-2.408.907 3.253 3.253 0 0 0-.879 2.408v8.328a.656.656 0 0 1-.2.482.716.716 0 0 1-.482.17zm12.234 0a.593.593 0 0 1-.651-.652v-11.814h-2.408a.592.592 0 0 1-.651-.651v-.963a.611.611 0 0 1 .17-.453.654.654 0 0 1 .481-.2h2.408v-1.417q0-4.816 4.872-4.815h1.586a.679.679 0 0 1 .652.651v.963a.656.656 0 0 1-.2.481.613.613 0 0 1-.453.17h-1.529a2.1 2.1 0 0 0-1.785.68 3.248 3.248 0 0 0-.51 2.011v1.275h6.062V863.7a.613.613 0 0 1 .17-.453.656.656 0 0 1 .482-.2h1.3a.679.679 0 0 1 .652.651v19.659a.655.655 0 0 1-.2.482.613.613 0 0 1-.454.17h-1.3a.592.592 0 0 1-.652-.652v-11.811h-6.062v11.813a.657.657 0 0 1-.2.482.614.614 0 0 1-.454.17zm20.9.283a6.487 6.487 0 0 1-4.844-1.757 6.837 6.837 0 0 1-1.813-4.674l-.029-1.218.029-1.218a6.732 6.732 0 0 1 1.841-4.646 7.389 7.389 0 0 1 9.631 0 6.736 6.736 0 0 1 1.841 4.646q.028.311.028 1.218t-.028 1.218a6.772 6.772 0 0 1-1.841 4.674 6.391 6.391 0 0 1-4.82 1.756zm0-2.181a3.582 3.582 0 0 0 2.8-1.133 4.931 4.931 0 0 0 1.133-3.258q.028-.283.028-1.076t-.028-1.076a4.931 4.931 0 0 0-1.133-3.258 3.582 3.582 0 0 0-2.8-1.133 3.671 3.671 0 0 0-2.833 1.133 4.83 4.83 0 0 0-1.1 3.258l-.028 1.076.028 1.076a4.83 4.83 0 0 0 1.1 3.258 3.671 3.671 0 0 0 2.828 1.132zm13.755 1.9a.846.846 0 0 1-.566-.17 1.321 1.321 0 0 1-.34-.538l-4.023-13.144-.056-.283a.575.575 0 0 1 .17-.425.641.641 0 0 1 .425-.17h1.246a.612.612 0 0 1 .453.17.646.646 0 0 1 .255.312l3.145 10.679 3.371-10.566a.761.761 0 0 1 .255-.4.726.726 0 0 1 .538-.2h.963a.728.728 0 0 1 .539.2.76.76 0 0 1 .255.4l3.371 10.566 3.144-10.679a.655.655 0 0 1 .2-.312.714.714 0 0 1 .482-.17h1.275a.542.542 0 0 1 .4.17.576.576 0 0 1 .17.425l-.057.283-3.994 13.144a1.323 1.323 0 0 1-.34.538.9.9 0 0 1-.6.17h-1.1a.86.86 0 0 1-.935-.708l-3.286-10.141-3.286 10.141a.928.928 0 0 1-.963.708z" fill="#51504f" data-name="Path 11" transform="translate(-1454.66 -838.62)"></path>
                                </g>
                            </g>
                        </g>
                    </svg>

                </a>
            </div>

            <div id="content-close-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="19.799" height="19.799" viewBox="0 0 19.799 19.799">
                    <g id="Group_1574" data-name="Group 1574" transform="translate(-41.892 290.899)">
                        <g id="Group_1291" data-name="Group 1291" transform="rotate(-45 -308.114 -187.077)">
                            <rect id="Rectangle_461" width="26" height="2" fill="#51504f" data-name="Rectangle 461" rx="1" transform="translate(-.209)"></rect>
                        </g>
                        <g id="Group_1292" data-name="Group 1292" transform="rotate(45 372.48 -93.011)">
                            <rect id="Rectangle_462" width="26" height="2" fill="#51504f" data-name="Rectangle 462" rx="1" transform="translate(-.209 -.178)"></rect>
                        </g>
                    </g>
                </svg>

            </div>

        </nav>
        <div class="content-drawer-container" id="content-drawer">
            <div class="content-drawer">
                <div class="td-sidebar">

<div id="docs-version-selector" class="docs-version-selector sidebar__version-selector">
    <a class="dropdown-toggle" href="#" id="versionDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
       aria-expanded="false">
        <span class="bodytext__medium--greyish-brown">Version: </span><span class="version">2.7.3</span>
    </a>
    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">

    </div>
    <script type="application/x-template" id="version-item-template">
        <a class="dropdown-item"></a>
    </script>
</div>

<div class="searchb-box">
    <form class="search-form" action="search.html" method="get">
        <input class="search-form__input" type="text" name="q" placeholder="Search docs" size="16">
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />

        <button class="search-form__button" type="submit">

            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
                <g id="Group_1579" data-name="Group 1579" transform="translate(-41.001 -41)">
                    <path id="Path_169" d="M71.415 64.687a7.215 7.215 0 1 0-6.729 6.728 7.222 7.222 0 0 0 6.729-6.728z" fill="none" data-name="Path 169" transform="translate(-14.277 -14.276)"></path>
                    <path id="Path_170" d="M60.863 59.8l-6.093-6.09a7.78 7.78 0 1 0-1.06 1.06l6.09 6.093a.468.468 0 0 0 .662 0l.4-.4a.468.468 0 0 0 .001-.663zM42.512 49.183a6.274 6.274 0 1 1 5.851 5.85 6.28 6.28 0 0 1-5.851-5.85z" fill="#51504f" data-name="Path 170"></path>
                </g>
            </svg>
        </button>
    </form>
</div>


<style>
    .searchb-box {
        margin-bottom: 26px;
    }
    .searchb-box .search-form {
        width: 100%;
        margin-top: 20px;
    }
</style>


<div class="toctree" role="navigation" aria-label="main navigation">
    <p class="caption" role="heading"><span class="caption-text">Content</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation/index.html">Installation of Airflow™</a></li>
<li class="toctree-l1"><a class="reference internal" href="security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto/index.html">How-to Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="ui.html">UI / Screenshots</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-concepts/index.html">Core Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="authoring-and-scheduling/index.html">Authoring and Scheduling</a></li>
<li class="toctree-l1"><a class="reference internal" href="administration-and-deployment/index.html">Administration and Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="integration.html">Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="public-airflow-interface.html">Public Interface of Airflow</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Best Practices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#writing-a-dag">Writing a DAG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-custom-operator-hook">Creating a Custom Operator/Hook</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-task">Creating a task</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deleting-a-task">Deleting a task</a></li>
<li class="toctree-l3"><a class="reference internal" href="#communication">Communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#top-level-python-code">Top level Python Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-check-if-my-code-is-top-level-code">How to check if my code is “top-level” code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-dag-generation">Dynamic DAG Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#airflow-variables">Airflow Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timetables">Timetables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#triggering-dags-after-changes">Triggering DAGs after changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-of-watcher-pattern-with-trigger-rules">Example of watcher pattern with trigger rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-airflowclusterpolicyskipdag-exception-in-cluster-policies-to-skip-specific-dags">Using AirflowClusterPolicySkipDag exception in cluster policies to skip specific DAGs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reducing-dag-complexity">Reducing DAG complexity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-a-dag">Testing a DAG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dag-loader-test">DAG Loader Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unit-tests">Unit tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#self-checks">Self-Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#staging-environment">Staging environment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mocking-variables-and-connections">Mocking variables and connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metadata-db-maintenance">Metadata DB maintenance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#upgrades-and-downgrades">Upgrades and downgrades</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#backup-your-database">Backup your database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#disable-the-scheduler">Disable the scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-integration-test-dags">Add “integration test” DAGs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prune-data-before-upgrading">Prune data before upgrading</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#handling-conflicting-complex-python-dependencies">Handling conflicting/complex Python dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-pythonvirtualenvoperator">Using PythonVirtualenvOperator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-externalpythonoperator">Using ExternalPythonOperator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-dockeroperator-or-kubernetes-pod-operator">Using DockerOperator or Kubernetes Pod Operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-multiple-docker-images-and-celery-queues">Using multiple Docker Images and Celery Queues</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-process.html">Release Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="privacy_notice.html">Privacy Notice</a></li>
<li class="toctree-l1"><a class="reference internal" href="project.html">Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="operators-and-hooks-ref.html">Operators and hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli-and-env-variables-ref.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates-ref.html">Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="stable-rest-api-ref.html">Stable REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="deprecated-rest-api-ref.html">Deprecated REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="configurations-ref.html">Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="extra-packages-ref.html">Extra packages</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Internal DB details</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="migrations-ref.html">Database Migrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="database-erd-ref.html">Database ERD Schema</a></li>
</ul>

</div>

<style type="text/css">
    .toctree {
    }
    .toctree li {
        list-style: none;
    }
    .toctree .caption {
        font-family: Roboto;
        font-size: 18px;
        font-weight: bold;
        font-stretch: normal;
        font-style: normal;
        line-height: 1.33;
        letter-spacing: normal;
        color: #51504f;
        padding-bottom: 13px;
        text-transform: uppercase;
        margin-bottom: 0;
    }
    .toctree .current > a:not([href="#"])  {
        color: #017cee;
    }
    .toctree > ul {
        padding-left: 0;
    }
    .toctree ul {
        padding-left: 15px;
        display: none;
    }
    .toctree > ul,
    .toctree li.current > ul {
        display: block;
    }

    .toctree a .toctree-expand {
        display: inline-block;
        position: relative;
        height: 1em;
    }

    .toctree a .toctree-expand:before {
        position: absolute;
        top: 6px;
        left: -12px;
        content: '►';
        font-size: 7px;
    }
    .toctree .current > a > .toctree-expand:before {
        content: '▼';
    }

    .toctree .current {
        color: #017cee;
    }
    .toctree li {
        font-family: Roboto;
        font-size: 16px;
        font-weight: normal;
        font-stretch: normal;
        font-style: normal;
        line-height: 1.63;
        letter-spacing: normal;
        color: #707070;
    }

</style>
                </div>
            </div>
        </div>
    </div>
        
        <div class="d-flex">
            
            
    <div class="td-sidebar desktop-only d-print-none">

<div id="docs-version-selector" class="docs-version-selector sidebar__version-selector">
    <a class="dropdown-toggle" href="#" id="versionDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
       aria-expanded="false">
        <span class="bodytext__medium--greyish-brown">Version: </span><span class="version">2.7.3</span>
    </a>
    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">

    </div>
    <script type="application/x-template" id="version-item-template">
        <a class="dropdown-item"></a>
    </script>
</div>

<div class="searchb-box">
    <form class="search-form" action="search.html" method="get">
        <input class="search-form__input" type="text" name="q" placeholder="Search docs" size="16">
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />

        <button class="search-form__button" type="submit">

            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
                <g id="Group_1579" data-name="Group 1579" transform="translate(-41.001 -41)">
                    <path id="Path_169" d="M71.415 64.687a7.215 7.215 0 1 0-6.729 6.728 7.222 7.222 0 0 0 6.729-6.728z" fill="none" data-name="Path 169" transform="translate(-14.277 -14.276)"></path>
                    <path id="Path_170" d="M60.863 59.8l-6.093-6.09a7.78 7.78 0 1 0-1.06 1.06l6.09 6.093a.468.468 0 0 0 .662 0l.4-.4a.468.468 0 0 0 .001-.663zM42.512 49.183a6.274 6.274 0 1 1 5.851 5.85 6.28 6.28 0 0 1-5.851-5.85z" fill="#51504f" data-name="Path 170"></path>
                </g>
            </svg>
        </button>
    </form>
</div>


<style>
    .searchb-box {
        margin-bottom: 26px;
    }
    .searchb-box .search-form {
        width: 100%;
        margin-top: 20px;
    }
</style>


<div class="toctree" role="navigation" aria-label="main navigation">
    <p class="caption" role="heading"><span class="caption-text">Content</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation/index.html">Installation of Airflow™</a></li>
<li class="toctree-l1"><a class="reference internal" href="security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto/index.html">How-to Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="ui.html">UI / Screenshots</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-concepts/index.html">Core Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="authoring-and-scheduling/index.html">Authoring and Scheduling</a></li>
<li class="toctree-l1"><a class="reference internal" href="administration-and-deployment/index.html">Administration and Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="integration.html">Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="public-airflow-interface.html">Public Interface of Airflow</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Best Practices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#writing-a-dag">Writing a DAG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-custom-operator-hook">Creating a Custom Operator/Hook</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-task">Creating a task</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deleting-a-task">Deleting a task</a></li>
<li class="toctree-l3"><a class="reference internal" href="#communication">Communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#top-level-python-code">Top level Python Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-check-if-my-code-is-top-level-code">How to check if my code is “top-level” code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-dag-generation">Dynamic DAG Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#airflow-variables">Airflow Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timetables">Timetables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#triggering-dags-after-changes">Triggering DAGs after changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-of-watcher-pattern-with-trigger-rules">Example of watcher pattern with trigger rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-airflowclusterpolicyskipdag-exception-in-cluster-policies-to-skip-specific-dags">Using AirflowClusterPolicySkipDag exception in cluster policies to skip specific DAGs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reducing-dag-complexity">Reducing DAG complexity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-a-dag">Testing a DAG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dag-loader-test">DAG Loader Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unit-tests">Unit tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#self-checks">Self-Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#staging-environment">Staging environment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mocking-variables-and-connections">Mocking variables and connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metadata-db-maintenance">Metadata DB maintenance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#upgrades-and-downgrades">Upgrades and downgrades</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#backup-your-database">Backup your database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#disable-the-scheduler">Disable the scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-integration-test-dags">Add “integration test” DAGs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prune-data-before-upgrading">Prune data before upgrading</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#handling-conflicting-complex-python-dependencies">Handling conflicting/complex Python dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-pythonvirtualenvoperator">Using PythonVirtualenvOperator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-externalpythonoperator">Using ExternalPythonOperator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-dockeroperator-or-kubernetes-pod-operator">Using DockerOperator or Kubernetes Pod Operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-multiple-docker-images-and-celery-queues">Using multiple Docker Images and Celery Queues</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-process.html">Release Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="privacy_notice.html">Privacy Notice</a></li>
<li class="toctree-l1"><a class="reference internal" href="project.html">Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="operators-and-hooks-ref.html">Operators and hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli-and-env-variables-ref.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates-ref.html">Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="stable-rest-api-ref.html">Stable REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="deprecated-rest-api-ref.html">Deprecated REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="configurations-ref.html">Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="extra-packages-ref.html">Extra packages</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Internal DB details</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="migrations-ref.html">Database Migrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="database-erd-ref.html">Database ERD Schema</a></li>
</ul>

</div>

<style type="text/css">
    .toctree {
    }
    .toctree li {
        list-style: none;
    }
    .toctree .caption {
        font-family: Roboto;
        font-size: 18px;
        font-weight: bold;
        font-stretch: normal;
        font-style: normal;
        line-height: 1.33;
        letter-spacing: normal;
        color: #51504f;
        padding-bottom: 13px;
        text-transform: uppercase;
        margin-bottom: 0;
    }
    .toctree .current > a:not([href="#"])  {
        color: #017cee;
    }
    .toctree > ul {
        padding-left: 0;
    }
    .toctree ul {
        padding-left: 15px;
        display: none;
    }
    .toctree > ul,
    .toctree li.current > ul {
        display: block;
    }

    .toctree a .toctree-expand {
        display: inline-block;
        position: relative;
        height: 1em;
    }

    .toctree a .toctree-expand:before {
        position: absolute;
        top: 6px;
        left: -12px;
        content: '►';
        font-size: 7px;
    }
    .toctree .current > a > .toctree-expand:before {
        content: '▼';
    }

    .toctree .current {
        color: #017cee;
    }
    .toctree li {
        font-family: Roboto;
        font-size: 16px;
        font-weight: normal;
        font-stretch: normal;
        font-style: normal;
        line-height: 1.63;
        letter-spacing: normal;
        color: #707070;
    }

</style>
    </div>
            

            

            <main class="col-12 col-md-9 col-xl-8" role="main">
                


    




<div role="navigation" aria-label="breadcrumbs navigation" class="d-none d-md-block d-print-none">

    <ul class="breadcrumb">
        
            <li class="breadcrumb-item"><a href="index.html" class="icon icon-home"> Home</a></li>
            
            <li class="breadcrumb-item"><a href="best-practices.html"> Best Practices</a></li>
        
    </ul>
</div>
                
                <div class="rst-content">
                    <div class="document">
                            <div class="documentwrapper">
                                <div class="bodywrapper">
                                    <div class="body" role="main">
                                        
  <blockquote>
<div></div></blockquote>
<div class="section" id="best-practices">
<span id="best-practice"></span><h1>Best Practices<a class="headerlink" href="#best-practices" title="Permalink to this heading">¶</a></h1>
<p>Creating a new DAG is a three-step process:</p>
<ul class="simple">
<li><p>writing Python code to create a DAG object,</p></li>
<li><p>testing if the code meets your expectations,</p></li>
<li><p>configuring environment dependencies to run your DAG</p></li>
</ul>
<p>This tutorial will introduce you to the best practices for these three steps.</p>
<div class="section" id="writing-a-dag">
<span id="best-practice-writing-a-dag"></span><h2>Writing a DAG<a class="headerlink" href="#writing-a-dag" title="Permalink to this heading">¶</a></h2>
<p>Creating a new DAG in Airflow is quite simple. However, there are many things that you need to take care of
to ensure the DAG run or failure does not produce unexpected results.</p>
<div class="section" id="creating-a-custom-operator-hook">
<h3>Creating a Custom Operator/Hook<a class="headerlink" href="#creating-a-custom-operator-hook" title="Permalink to this heading">¶</a></h3>
<p>Please follow our guide on <a class="reference internal" href="howto/custom-operator.html#custom-operator"><span class="std std-ref">custom Operators</span></a>.</p>
</div>
<div class="section" id="creating-a-task">
<h3>Creating a task<a class="headerlink" href="#creating-a-task" title="Permalink to this heading">¶</a></h3>
<p>You should treat tasks in Airflow equivalent to transactions in a database. This
implies that you should never produce incomplete results from your tasks. An
example is not to produce incomplete data in <code class="docutils literal notranslate"><span class="pre">HDFS</span></code> or <code class="docutils literal notranslate"><span class="pre">S3</span></code> at the end of a
task.</p>
<p>Airflow can retry a task if it fails. Thus, the tasks should produce the same
outcome on every re-run. Some of the ways you can avoid producing a different
result -</p>
<ul class="simple">
<li><p>Do not use INSERT during a task re-run, an INSERT statement might lead to
duplicate rows in your database. Replace it with UPSERT.</p></li>
<li><p>Read and write in a specific partition. Never read the latest available data
in a task. Someone may update the input data between re-runs, which results in
different outputs. A better way is to read the input data from a specific
partition. You can use <code class="docutils literal notranslate"><span class="pre">data_interval_start</span></code> as a partition. You should
follow this partitioning method while writing data in S3/HDFS as well.</p></li>
<li><p>The Python datetime <code class="docutils literal notranslate"><span class="pre">now()</span></code> function gives the current datetime object. This
function should never be used inside a task, especially to do the critical
computation, as it leads to different outcomes on each run. It’s fine to use
it, for example, to generate a temporary log.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You should define repetitive parameters such as <code class="docutils literal notranslate"><span class="pre">connection_id</span></code> or S3 paths in <code class="docutils literal notranslate"><span class="pre">default_args</span></code> rather than declaring them for each task.
The <code class="docutils literal notranslate"><span class="pre">default_args</span></code> help to avoid mistakes such as typographical errors. Also, most connection types have unique parameter names in
tasks, so you can declare a connection only once in <code class="docutils literal notranslate"><span class="pre">default_args</span></code> (for example <code class="docutils literal notranslate"><span class="pre">gcp_conn_id</span></code>) and it is automatically
used by all operators that use this connection type.</p>
</div>
</div>
<div class="section" id="deleting-a-task">
<h3>Deleting a task<a class="headerlink" href="#deleting-a-task" title="Permalink to this heading">¶</a></h3>
<p>Be careful when deleting a task from a DAG. You would not be able to see the Task in Graph View, Grid View, etc making
it difficult to check the logs of that Task from the Webserver. If that is not desired, please create a new DAG.</p>
</div>
<div class="section" id="communication">
<h3>Communication<a class="headerlink" href="#communication" title="Permalink to this heading">¶</a></h3>
<p>Airflow executes tasks of a DAG on different servers in case you are using <a class="reference internal" href="core-concepts/executor/kubernetes.html"><span class="doc">Kubernetes executor</span></a> or <a class="reference internal" href="core-concepts/executor/celery.html"><span class="doc">Celery executor</span></a>.
Therefore, you should not store any file or config in the local filesystem as the next task is likely to run on a different server without access to it — for example, a task that downloads the data file that the next task processes.
In the case of <code class="xref py py-class docutils literal notranslate"><span class="pre">Local</span> <span class="pre">executor</span></code>,
storing a file on disk can make retries harder e.g., your task requires a config file that is deleted by another task in DAG.</p>
<p>If possible, use <code class="docutils literal notranslate"><span class="pre">XCom</span></code> to communicate small messages between tasks and a good way of passing larger data between tasks is to use a remote storage such as S3/HDFS.
For example, if we have a task that stores processed data in S3 that task can push the S3 path for the output data in <code class="docutils literal notranslate"><span class="pre">Xcom</span></code>,
and the downstream tasks can pull the path from XCom and use it to read the data.</p>
<p>The tasks should also not store any authentication parameters such as passwords or token inside them.
Where at all possible, use <a class="reference internal" href="authoring-and-scheduling/connections.html"><span class="doc">Connections</span></a> to store data securely in Airflow backend and retrieve them using a unique connection id.</p>
</div>
<div class="section" id="top-level-python-code">
<span id="best-practices-top-level-code"></span><h3>Top level Python Code<a class="headerlink" href="#top-level-python-code" title="Permalink to this heading">¶</a></h3>
<p>You should avoid writing the top level code which is not necessary to create Operators
and build DAG relations between them. This is because of the design decision for the scheduler of Airflow
and the impact the top-level code parsing speed on both performance and scalability of Airflow.</p>
<p>Airflow scheduler executes the code outside the Operator’s <code class="docutils literal notranslate"><span class="pre">execute</span></code> methods with the minimum interval of
<a class="reference internal" href="configurations-ref.html#config-scheduler-min-file-process-interval"><span class="std std-ref">min_file_process_interval</span></a> seconds. This is done in order
to allow dynamic scheduling of the DAGs - where scheduling and dependencies might change over time and
impact the next schedule of the DAG. Airflow scheduler tries to continuously make sure that what you have
in DAGs is correctly reflected in scheduled tasks.</p>
<p>Specifically you should not run any database access, heavy computations and networking operations.</p>
<p>One of the important factors impacting DAG loading time, that might be overlooked by Python developers is
that top-level imports might take surprisingly a lot of time and they can generate a lot of overhead
and this can be easily avoided by converting them to local imports inside Python callables for example.</p>
<p>Consider the example below - the first DAG will parse significantly slower (in the orders of seconds)
than equivalent DAG where the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> module is imported as local import in the callable.</p>
<p>Bad example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pendulum</span>

<span class="kn">from</span> <span class="nn">airflow</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="kn">from</span> <span class="nn">airflow.decorators</span> <span class="kn">import</span> <span class="n">task</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># &lt;-- THIS IS A VERY BAD IDEA! DON&#39;T DO THAT!</span>

<span class="k">with</span> <span class="n">DAG</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;example_python_operator&quot;</span><span class="p">,</span>
    <span class="n">schedule</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">pendulum</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="s2">&quot;UTC&quot;</span><span class="p">),</span>
    <span class="n">catchup</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;example&quot;</span><span class="p">],</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">dag</span><span class="p">:</span>

    <span class="nd">@task</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">print_array</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print Numpy array.&quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span>

    <span class="n">print_array</span><span class="p">()</span>
</pre></div>
</div>
<p>Good example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pendulum</span>

<span class="kn">from</span> <span class="nn">airflow</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="kn">from</span> <span class="nn">airflow.decorators</span> <span class="kn">import</span> <span class="n">task</span>

<span class="k">with</span> <span class="n">DAG</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;example_python_operator&quot;</span><span class="p">,</span>
    <span class="n">schedule</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">pendulum</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="s2">&quot;UTC&quot;</span><span class="p">),</span>
    <span class="n">catchup</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;example&quot;</span><span class="p">],</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">dag</span><span class="p">:</span>

    <span class="nd">@task</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">print_array</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print Numpy array.&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># &lt;- THIS IS HOW NUMPY SHOULD BE IMPORTED IN THIS CASE!</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span>

    <span class="n">print_array</span><span class="p">()</span>
</pre></div>
</div>
<p>In the Bad example, NumPy is imported each time the DAG file is parsed, which will result in suboptimal performance in the DAG file processing. In the Good example, NumPy is only imported when the task is running.</p>
<p>Since it is not always obvious, see the next chapter to check how my code is “top-level” code.</p>
</div>
<div class="section" id="how-to-check-if-my-code-is-top-level-code">
<h3>How to check if my code is “top-level” code<a class="headerlink" href="#how-to-check-if-my-code-is-top-level-code" title="Permalink to this heading">¶</a></h3>
<p>In order to understand whether your code is “top-level” or not you need to understand a lot of
intricacies of how parsing Python works. In general, when Python parses the python file it executes
the code it sees, except (in general) internal code of the methods that it does not execute.</p>
<p>It has a number of special cases that are not obvious - for example top-level code also means
any code that is used to determine default values of methods.</p>
<p>However, there is an easy way to check whether your code is “top-level” or not. You simply need to
parse your code and see if the piece of code gets executed.</p>
<p>Imagine this code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">airflow</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="kn">from</span> <span class="nn">airflow.operators.python</span> <span class="kn">import</span> <span class="n">PythonOperator</span>
<span class="kn">import</span> <span class="nn">pendulum</span>


<span class="k">def</span> <span class="nf">get_task_id</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;print_array_task&quot;</span>  <span class="c1"># &lt;- is that code going to be executed?</span>


<span class="k">def</span> <span class="nf">get_array</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># &lt;- is that code going to be executed?</span>


<span class="k">with</span> <span class="n">DAG</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;example_python_operator&quot;</span><span class="p">,</span>
    <span class="n">schedule</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">pendulum</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="s2">&quot;UTC&quot;</span><span class="p">),</span>
    <span class="n">catchup</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;example&quot;</span><span class="p">],</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">dag</span><span class="p">:</span>

    <span class="n">operator</span> <span class="o">=</span> <span class="n">PythonOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="n">get_task_id</span><span class="p">(),</span>
        <span class="n">python_callable</span><span class="o">=</span><span class="n">get_array</span><span class="p">,</span>
        <span class="n">dag</span><span class="o">=</span><span class="n">dag</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>What you can do check it, add to your code you want to check some print statements and run
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">&lt;my_dag_file&gt;.py</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">airflow</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="kn">from</span> <span class="nn">airflow.operators.python</span> <span class="kn">import</span> <span class="n">PythonOperator</span>
<span class="kn">import</span> <span class="nn">pendulum</span>


<span class="k">def</span> <span class="nf">get_task_id</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Executing 1&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;print_array_task&quot;</span>  <span class="c1"># &lt;- is that code going to be executed? YES</span>


<span class="k">def</span> <span class="nf">get_array</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Executing 2&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># &lt;- is that code going to be executed? NO</span>


<span class="k">with</span> <span class="n">DAG</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;example_python_operator&quot;</span><span class="p">,</span>
    <span class="n">schedule</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">pendulum</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="s2">&quot;UTC&quot;</span><span class="p">),</span>
    <span class="n">catchup</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;example&quot;</span><span class="p">],</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">dag</span><span class="p">:</span>

    <span class="n">operator</span> <span class="o">=</span> <span class="n">PythonOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="n">get_task_id</span><span class="p">(),</span>
        <span class="n">python_callable</span><span class="o">=</span><span class="n">get_array</span><span class="p">,</span>
        <span class="n">dag</span><span class="o">=</span><span class="n">dag</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>When you execute that code you will see:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@cf85ab34571e:/opt/airflow#<span class="w"> </span>python<span class="w"> </span>/files/test_python.py
Executing<span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<p>This means that the <code class="docutils literal notranslate"><span class="pre">get_array</span></code> is not executed as top-level code, but <code class="docutils literal notranslate"><span class="pre">get_task_id</span></code> is.</p>
</div>
<div class="section" id="dynamic-dag-generation">
<span id="best-practices-dynamic-dag-generation"></span><h3>Dynamic DAG Generation<a class="headerlink" href="#dynamic-dag-generation" title="Permalink to this heading">¶</a></h3>
<p>Sometimes writing DAGs manually isn’t practical.
Maybe you have a lot of DAGs that do similar things with just a parameter changing between them.
Or maybe you need a set of DAGs to load tables, but don’t want to manually update DAGs every time those tables change.
In these and other cases, it can be more useful to dynamically generate DAGs.</p>
<p>Avoiding excessive processing at the top level code described in the previous chapter is especially important
in case of dynamic DAG configuration, which can be configured essentially in one of those ways:</p>
<ul class="simple">
<li><p>via <a class="reference external" href="https://wiki.archlinux.org/title/environment_variables">environment variables</a> (not to be mistaken
with the <a class="reference internal" href="core-concepts/variables.html"><span class="doc">Airflow Variables</span></a>)</p></li>
<li><p>via externally provided, generated Python code, containing meta-data in the DAG folder</p></li>
<li><p>via externally provided, generated configuration meta-data file in the DAG folder</p></li>
</ul>
<p>Some cases of dynamic DAG generation are described in the <a class="reference internal" href="howto/dynamic-dag-generation.html"><span class="doc">Dynamic DAG Generation</span></a> section.</p>
</div>
<div class="section" id="airflow-variables">
<span id="best-practices-airflow-variables"></span><h3>Airflow Variables<a class="headerlink" href="#airflow-variables" title="Permalink to this heading">¶</a></h3>
<p>Using Airflow Variables yields network calls and database access, so their usage in top-level Python code for DAGs
should be avoided as much as possible, as mentioned in the previous chapter, <a class="reference internal" href="#best-practices-top-level-code"><span class="std std-ref">Top level Python Code</span></a>.
If Airflow Variables must be used in top-level DAG code, then their impact on DAG parsing can be mitigated by
<a class="reference internal" href="configurations-ref.html#config-secrets-use-cache"><span class="std std-ref">enabling the experimental cache</span></a>, configured with a sensible <a class="reference internal" href="configurations-ref.html#config-secrets-cache-ttl-seconds"><span class="std std-ref">ttl</span></a>.</p>
<p>You can use the Airflow Variables freely inside the <code class="docutils literal notranslate"><span class="pre">execute()</span></code> methods of the operators, but you can also pass the
Airflow Variables to the existing operators via Jinja template, which will delay reading the value until the task execution.</p>
<p>The template syntax to do this is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">var</span><span class="o">.</span><span class="n">value</span><span class="o">.&lt;</span><span class="n">variable_name</span><span class="o">&gt;</span> <span class="p">}}</span>
</pre></div>
</div>
<p>or if you need to deserialize a json object from the variable :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">var</span><span class="o">.</span><span class="n">json</span><span class="o">.&lt;</span><span class="n">variable_name</span><span class="o">&gt;</span> <span class="p">}}</span>
</pre></div>
</div>
<p>In top-level code, variables using jinja templates do not produce a request until a task is running, whereas,
<code class="docutils literal notranslate"><span class="pre">Variable.get()</span></code> produces a request every time the dag file is parsed by the scheduler if caching is not enabled.
Using <code class="docutils literal notranslate"><span class="pre">Variable.get()</span></code> without <a class="reference internal" href="configurations-ref.html#config-secrets-use-cache"><span class="std std-ref">enabling caching</span></a> will lead to suboptimal
performance in the dag file processing.
In some cases this can cause the dag file to timeout before it is fully parsed.</p>
<p>Bad example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">airflow.models</span> <span class="kn">import</span> <span class="n">Variable</span>

<span class="n">foo_var</span> <span class="o">=</span> <span class="n">Variable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>  <span class="c1"># AVOID THAT</span>
<span class="n">bash_use_variable_bad_1</span> <span class="o">=</span> <span class="n">BashOperator</span><span class="p">(</span>
    <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;bash_use_variable_bad_1&quot;</span><span class="p">,</span> <span class="n">bash_command</span><span class="o">=</span><span class="s2">&quot;echo variable foo=$</span><span class="si">{foo_env}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;foo_env&quot;</span><span class="p">:</span> <span class="n">foo_var</span><span class="p">}</span>
<span class="p">)</span>

<span class="n">bash_use_variable_bad_2</span> <span class="o">=</span> <span class="n">BashOperator</span><span class="p">(</span>
    <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;bash_use_variable_bad_2&quot;</span><span class="p">,</span>
    <span class="n">bash_command</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;echo variable foo=$</span><span class="si">{</span><span class="n">Variable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># AVOID THAT</span>
<span class="p">)</span>

<span class="n">bash_use_variable_bad_3</span> <span class="o">=</span> <span class="n">BashOperator</span><span class="p">(</span>
    <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;bash_use_variable_bad_3&quot;</span><span class="p">,</span>
    <span class="n">bash_command</span><span class="o">=</span><span class="s2">&quot;echo variable foo=$</span><span class="si">{foo_env}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;foo_env&quot;</span><span class="p">:</span> <span class="n">Variable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)},</span>  <span class="c1"># AVOID THAT</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Good example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bash_use_variable_good</span> <span class="o">=</span> <span class="n">BashOperator</span><span class="p">(</span>
    <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;bash_use_variable_good&quot;</span><span class="p">,</span>
    <span class="n">bash_command</span><span class="o">=</span><span class="s2">&quot;echo variable foo=$</span><span class="si">{foo_env}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;foo_env&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ var.value.get(&#39;foo&#39;) }}&quot;</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">my_task</span><span class="p">():</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">Variable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>  <span class="c1"># this is fine, because func my_task called only run task, not scan DAGs.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>
</div>
<p>For security purpose, you’re recommended to use the <a class="reference internal" href="security/secrets/secrets-backend/index.html#secrets-backend-configuration"><span class="std std-ref">Secrets Backend</span></a>
for any variable that contains sensitive data.</p>
</div>
<div class="section" id="timetables">
<span id="best-practices-timetables"></span><h3>Timetables<a class="headerlink" href="#timetables" title="Permalink to this heading">¶</a></h3>
<p>Avoid using Airflow Variables/Connections or accessing airflow database at the top level of your timetable code.
Database access should be delayed until the execution time of the DAG. This means that you should not have variables/connections retrieval
as argument to your timetable class initialization or have Variable/connection at the top level of your custom timetable module.</p>
<p>Bad example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">airflow.models.variable</span> <span class="kn">import</span> <span class="n">Variable</span>
<span class="kn">from</span> <span class="nn">airflow.timetables.interval</span> <span class="kn">import</span> <span class="n">CronDataIntervalTimetable</span>


<span class="k">class</span> <span class="nc">CustomTimetable</span><span class="p">(</span><span class="n">CronDataIntervalTimetable</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">something</span><span class="o">=</span><span class="n">Variable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;something&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_something</span> <span class="o">=</span> <span class="n">something</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>Good example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">airflow.models.variable</span> <span class="kn">import</span> <span class="n">Variable</span>
<span class="kn">from</span> <span class="nn">airflow.timetables.interval</span> <span class="kn">import</span> <span class="n">CronDataIntervalTimetable</span>


<span class="k">class</span> <span class="nc">CustomTimetable</span><span class="p">(</span><span class="n">CronDataIntervalTimetable</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">something</span><span class="o">=</span><span class="s2">&quot;something&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_something</span> <span class="o">=</span> <span class="n">Variable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">something</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="triggering-dags-after-changes">
<h3>Triggering DAGs after changes<a class="headerlink" href="#triggering-dags-after-changes" title="Permalink to this heading">¶</a></h3>
<p>Avoid triggering DAGs immediately after changing them or any other accompanying files that you change in the
DAG folder.</p>
<p>You should give the system sufficient time to process the changed files. This takes several steps.
First the files have to be distributed to scheduler - usually via distributed filesystem or Git-Sync, then
scheduler has to parse the Python files and store them in the database. Depending on your configuration,
speed of your distributed filesystem, number of files, number of DAGs, number of changes in the files,
sizes of the files, number of schedulers, speed of CPUS, this can take from seconds to minutes, in extreme
cases many minutes. You should wait for your DAG to appear in the UI to be able to trigger it.</p>
<p>In case you see long delays between updating it and the time it is ready to be triggered, you can look
at the following configuration parameters and fine tune them according your needs (see details of
each parameter by following the links):</p>
<ul class="simple">
<li><p><a class="reference internal" href="configurations-ref.html#config-scheduler-scheduler-idle-sleep-time"><span class="std std-ref">scheduler_idle_sleep_time</span></a></p></li>
<li><p><a class="reference internal" href="configurations-ref.html#config-scheduler-min-file-process-interval"><span class="std std-ref">min_file_process_interval</span></a></p></li>
<li><p><a class="reference internal" href="configurations-ref.html#config-scheduler-dag-dir-list-interval"><span class="std std-ref">dag_dir_list_interval</span></a></p></li>
<li><p><a class="reference internal" href="configurations-ref.html#config-scheduler-parsing-processes"><span class="std std-ref">parsing_processes</span></a></p></li>
<li><p><a class="reference internal" href="configurations-ref.html#config-scheduler-file-parsing-sort-mode"><span class="std std-ref">file_parsing_sort_mode</span></a></p></li>
</ul>
</div>
<div class="section" id="example-of-watcher-pattern-with-trigger-rules">
<h3>Example of watcher pattern with trigger rules<a class="headerlink" href="#example-of-watcher-pattern-with-trigger-rules" title="Permalink to this heading">¶</a></h3>
<p>The watcher pattern is how we call a DAG with a task that is “watching” the states of the other tasks.
Its primary purpose is to fail a DAG Run when any other task fail.
The need came from the Airflow system tests that are DAGs with different tasks (similarly like a test containing steps).</p>
<p>Normally, when any task fails, all other tasks are not executed and the whole DAG Run gets failed status too. But
when we use trigger rules, we can disrupt the normal flow of running tasks and the whole DAG may represent different
status that we expect. For example, we can have a teardown task (with trigger rule set to <code class="docutils literal notranslate"><span class="pre">TriggerRule.ALL_DONE</span></code>)
that will be executed regardless of the state of the other tasks (e.g. to clean up the resources). In such
situation, the DAG would always run this task and the DAG Run will get the status of this particular task, so we can
potentially lose the information about failing tasks. If we want to ensure that the DAG with teardown task would fail
if any task fails, we need to  use the watcher pattern. The watcher task is a task that will always fail if
triggered, but it needs to be triggered only if any other task fails. It needs to have a trigger rule set to
<code class="docutils literal notranslate"><span class="pre">TriggerRule.ONE_FAILED</span></code> and it needs also to be a  downstream task for all other tasks in the DAG. Thanks to
this, if every other task will pass, the watcher will be skipped, but when something fails, the watcher task will be
executed and fail making the DAG Run fail too.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be aware that trigger rules only rely on the direct upstream (parent) tasks, e.g. <code class="docutils literal notranslate"><span class="pre">TriggerRule.ONE_FAILED</span></code>
will ignore any failed (or <code class="docutils literal notranslate"><span class="pre">upstream_failed</span></code>) tasks that are not a direct parent of the parameterized task.</p>
</div>
<p>It’s easier to grab the concept with an example. Let’s say that we have the following DAG:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">from</span> <span class="nn">airflow</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="kn">from</span> <span class="nn">airflow.decorators</span> <span class="kn">import</span> <span class="n">task</span>
<span class="kn">from</span> <span class="nn">airflow.exceptions</span> <span class="kn">import</span> <span class="n">AirflowException</span>
<span class="kn">from</span> <span class="nn">airflow.operators.bash</span> <span class="kn">import</span> <span class="n">BashOperator</span>
<span class="kn">from</span> <span class="nn">airflow.utils.trigger_rule</span> <span class="kn">import</span> <span class="n">TriggerRule</span>


<span class="nd">@task</span><span class="p">(</span><span class="n">trigger_rule</span><span class="o">=</span><span class="n">TriggerRule</span><span class="o">.</span><span class="n">ONE_FAILED</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">watcher</span><span class="p">():</span>
    <span class="k">raise</span> <span class="n">AirflowException</span><span class="p">(</span><span class="s2">&quot;Failing task because one or more upstream tasks failed.&quot;</span><span class="p">)</span>


<span class="k">with</span> <span class="n">DAG</span><span class="p">(</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;watcher_example&quot;</span><span class="p">,</span>
    <span class="n">schedule</span><span class="o">=</span><span class="s2">&quot;@once&quot;</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">catchup</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">dag</span><span class="p">:</span>
    <span class="n">failing_task</span> <span class="o">=</span> <span class="n">BashOperator</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;failing_task&quot;</span><span class="p">,</span> <span class="n">bash_command</span><span class="o">=</span><span class="s2">&quot;exit 1&quot;</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">passing_task</span> <span class="o">=</span> <span class="n">BashOperator</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;passing_task&quot;</span><span class="p">,</span> <span class="n">bash_command</span><span class="o">=</span><span class="s2">&quot;echo passing_task&quot;</span><span class="p">)</span>
    <span class="n">teardown</span> <span class="o">=</span> <span class="n">BashOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;teardown&quot;</span><span class="p">,</span>
        <span class="n">bash_command</span><span class="o">=</span><span class="s2">&quot;echo teardown&quot;</span><span class="p">,</span>
        <span class="n">trigger_rule</span><span class="o">=</span><span class="n">TriggerRule</span><span class="o">.</span><span class="n">ALL_DONE</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">failing_task</span> <span class="o">&gt;&gt;</span> <span class="n">passing_task</span> <span class="o">&gt;&gt;</span> <span class="n">teardown</span>
    <span class="nb">list</span><span class="p">(</span><span class="n">dag</span><span class="o">.</span><span class="n">tasks</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">watcher</span><span class="p">()</span>
</pre></div>
</div>
<p>The visual representation of this DAG after execution looks like this:</p>
<img alt="_images/watcher.png" src="_images/watcher.png" />
<p>We have several tasks that serve different purposes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">failing_task</span></code> always fails,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">passing_task</span></code> always succeeds (if executed),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">teardown</span></code> is always triggered (regardless the states of the other tasks) and it should always succeed,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">watcher</span></code> is a downstream task for each other task, i.e. it will be triggered when any task fails and thus fail the whole DAG Run, since it’s a leaf task.</p></li>
</ul>
<p>It’s important to note, that without <code class="docutils literal notranslate"><span class="pre">watcher</span></code> task, the whole DAG Run will get the <code class="docutils literal notranslate"><span class="pre">success</span></code> state, since the only failing task is not the leaf task, and the <code class="docutils literal notranslate"><span class="pre">teardown</span></code> task will finish with <code class="docutils literal notranslate"><span class="pre">success</span></code>.
If we want the <code class="docutils literal notranslate"><span class="pre">watcher</span></code> to monitor the state of all tasks, we need to make it dependent on all of them separately. Thanks to this, we can fail the DAG Run if any of the tasks fail. Note that the watcher task has a trigger rule set to <code class="docutils literal notranslate"><span class="pre">&quot;one_failed&quot;</span></code>.
On the other hand, without the <code class="docutils literal notranslate"><span class="pre">teardown</span></code> task, the <code class="docutils literal notranslate"><span class="pre">watcher</span></code> task will not be needed, because <code class="docutils literal notranslate"><span class="pre">failing_task</span></code> will propagate its <code class="docutils literal notranslate"><span class="pre">failed</span></code> state to downstream task <code class="docutils literal notranslate"><span class="pre">passed_task</span></code> and the whole DAG Run will also get the <code class="docutils literal notranslate"><span class="pre">failed</span></code> status.</p>
</div>
<div class="section" id="using-airflowclusterpolicyskipdag-exception-in-cluster-policies-to-skip-specific-dags">
<h3>Using AirflowClusterPolicySkipDag exception in cluster policies to skip specific DAGs<a class="headerlink" href="#using-airflowclusterpolicyskipdag-exception-in-cluster-policies-to-skip-specific-dags" title="Permalink to this heading">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.7.</span></p>
</div>
<p>Airflow DAGs can usually be deployed and updated with the specific branch of Git repository via <code class="docutils literal notranslate"><span class="pre">git-sync</span></code>.
But, when you have to run multiple Airflow clusters for some operational reasons, it’s very cumbersome to maintain multiple Git branches.
Especially, you have some difficulties when you need to synchronize two separate branches(like <code class="docutils literal notranslate"><span class="pre">prod</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span></code>) periodically with proper branching strategy.</p>
<ul class="simple">
<li><p>cherry-pick is too cumbersome to maintain Git repository.</p></li>
<li><p>hard-reset is not recommended way for GitOps</p></li>
</ul>
<p>So, you can consider connecting multiple Airflow clusters with same Git branch (like <code class="docutils literal notranslate"><span class="pre">main</span></code>), and maintaining those with different environment variables and different connection configurations with same <code class="docutils literal notranslate"><span class="pre">connection_id</span></code>.
you can also raise <a class="reference internal" href="_api/airflow/exceptions/index.html#airflow.exceptions.AirflowClusterPolicySkipDag" title="airflow.exceptions.AirflowClusterPolicySkipDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">AirflowClusterPolicySkipDag</span></code></a> exception on the cluster policy, to load specific DAGs to <a class="reference internal" href="_api/airflow/models/dagbag/index.html#airflow.models.dagbag.DagBag" title="airflow.models.dagbag.DagBag"><code class="xref py py-class docutils literal notranslate"><span class="pre">DagBag</span></code></a> on the specific Airflow deployment only, if needed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dag_policy</span><span class="p">(</span><span class="n">dag</span><span class="p">:</span> <span class="n">DAG</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Skipping the DAG with `only_for_beta` tag.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="s2">&quot;only_for_beta&quot;</span> <span class="ow">in</span> <span class="n">dag</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AirflowClusterPolicySkipDag</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;DAG </span><span class="si">{</span><span class="n">dag</span><span class="o">.</span><span class="n">dag_id</span><span class="si">}</span><span class="s2"> is not loaded on the production cluster, due to `only_for_beta` tag.&quot;</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>The example above, shows the <code class="docutils literal notranslate"><span class="pre">dag_policy</span></code> code snippet to skip the DAG depending on the tags it has.</p>
</div>
</div>
<div class="section" id="reducing-dag-complexity">
<span id="best-practices-reducing-dag-complexity"></span><h2>Reducing DAG complexity<a class="headerlink" href="#reducing-dag-complexity" title="Permalink to this heading">¶</a></h2>
<p>While Airflow is good in handling a lot of DAGs with a lot of task and dependencies between them, when you
have many complex DAGs, their complexity might impact performance of scheduling. One of the ways to keep
your Airflow instance performant and well utilized, you should strive to simplify and optimize your DAGs
whenever possible - you have to remember that DAG parsing process and creation is just executing
Python code and it’s up to you to make it as performant as possible. There are no magic recipes for making
your DAG “less complex” - since this is a Python code, it’s the DAG writer who controls the complexity of
their code.</p>
<p>There are no “metrics” for DAG complexity, especially, there are no metrics that can tell you
whether your DAG is “simple enough”. However, as with any Python code, you can definitely tell that
your DAG code is “simpler” or “faster” when it is optimized. If you
want to optimize your DAGs there are the following actions you can take:</p>
<ul class="simple">
<li><p>Make your DAG load faster. This is a single improvement advice that might be implemented in various ways
but this is the one that has biggest impact on scheduler’s performance. Whenever you have a chance to make
your DAG load faster - go for it, if your goal is to improve performance. Look at the
<a class="reference internal" href="#best-practices-top-level-code"><span class="std std-ref">Top level Python Code</span></a> to get some tips of how you can do it. Also see at
<a class="reference internal" href="#best-practices-dag-loader-test"><span class="std std-ref">DAG Loader Test</span></a> on how to asses your DAG loading time.</p></li>
<li><p>Make your DAG generate simpler structure. Every task dependency adds additional processing overhead for
scheduling and execution. The DAG that has simple linear structure <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">-&gt;</span> <span class="pre">B</span> <span class="pre">-&gt;</span> <span class="pre">C</span></code> will experience
less delays in task scheduling than DAG that has a deeply nested tree structure with exponentially growing
number of depending tasks for example. If you can make your DAGs more linear - where at single point in
execution there are as few potential candidates to run among the tasks, this will likely improve overall
scheduling performance.</p></li>
<li><p>Make smaller number of DAGs per file. While Airflow 2 is optimized for the case of having multiple DAGs
in one file, there are some parts of the system that make it sometimes less performant, or introduce more
delays than having those DAGs split among many files. Just the fact that one file can only be parsed by one
FileProcessor, makes it less scalable for example. If you have many DAGs generated from one file,
consider splitting them if you observe it takes a long time to reflect changes in your DAG files in the
UI of Airflow.</p></li>
<li><p>Write efficient Python code. A balance must be struck between fewer DAGs per file, as stated above, and
writing less code overall. Creating the Python files that describe DAGs should follow best programming
practices and not be treated like configurations. If your DAGs share similar code you should not copy
them over and over again to a large number of nearly identical source files, as this will cause a
number of unnecessary repeated imports of the same resources. Rather, you should aim to minimize
repeated code across all of your DAGs so that the application can run efficiently and can be easily
debugged. See <a class="reference internal" href="#best-practices-dynamic-dag-generation"><span class="std std-ref">Dynamic DAG Generation</span></a> on how to create multiple DAGs with similar
code.</p></li>
</ul>
</div>
<div class="section" id="testing-a-dag">
<h2>Testing a DAG<a class="headerlink" href="#testing-a-dag" title="Permalink to this heading">¶</a></h2>
<p>Airflow users should treat DAGs as production level code, and DAGs should have various associated tests to
ensure that they produce expected results. You can write a wide variety of tests for a DAG.
Let’s take a look at some of them.</p>
<div class="section" id="dag-loader-test">
<span id="best-practices-dag-loader-test"></span><h3>DAG Loader Test<a class="headerlink" href="#dag-loader-test" title="Permalink to this heading">¶</a></h3>
<p>This test should ensure that your DAG does not contain a piece of code that raises error while loading.
No additional code needs to be written by the user to run this test.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>your-dag-file.py
</pre></div>
</div>
<p>Running the above command without any error ensures your DAG does not contain any uninstalled dependency,
syntax errors, etc. Make sure that you load your DAG in an environment that corresponds to your
scheduler environment - with the same dependencies, environment variables, common code referred from the
DAG.</p>
<p>This is also a great way to check if your DAG loads faster after an optimization, if you want to attempt
to optimize DAG loading time. Simply run the DAG and measure the time it takes, but again you have to
make sure your DAG runs with the same dependencies, environment variables, common code.</p>
<p>There are many ways to measure the time of processing, one of them in Linux environment is to
use built-in <code class="docutils literal notranslate"><span class="pre">time</span></code> command. Make sure to run it several times in succession to account for
caching effects. Compare the results before and after the optimization (in the same conditions - using
the same machine, environment etc.) in order to assess the impact of the optimization.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">time</span><span class="w"> </span>python<span class="w"> </span>airflow/example_dags/example_python_operator.py
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>real    0m0.699s
user    0m0.590s
sys     0m0.108s
</pre></div>
</div>
<p>The important metrics is the “real time” - which tells you how long time it took
to process the DAG. Note that when loading the file this way, you are starting a new interpreter so there is
an initial loading time that is not present when Airflow parses the DAG. You can assess the
time of initialization by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">time</span><span class="w"> </span>python<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;&#39;</span>
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>real    0m0.073s
user    0m0.037s
sys     0m0.039s
</pre></div>
</div>
<p>In this case the initial interpreter startup time is ~ 0.07s which is about 10% of time needed to parse
the example_python_operator.py above so the actual parsing time is about ~ 0.62 s for the example DAG.</p>
<p>You can look into <a class="reference internal" href="tutorial/fundamentals.html#testing"><span class="std std-ref">Testing a DAG</span></a> for details on how to test individual operators.</p>
</div>
<div class="section" id="unit-tests">
<h3>Unit tests<a class="headerlink" href="#unit-tests" title="Permalink to this heading">¶</a></h3>
<p>Unit tests ensure that there is no incorrect code in your DAG. You can write unit tests for both your tasks and your DAG.</p>
<p><strong>Unit test for loading a DAG:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytest</span>

<span class="kn">from</span> <span class="nn">airflow.models</span> <span class="kn">import</span> <span class="n">DagBag</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">dagbag</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">DagBag</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">test_dag_loaded</span><span class="p">(</span><span class="n">dagbag</span><span class="p">):</span>
    <span class="n">dag</span> <span class="o">=</span> <span class="n">dagbag</span><span class="o">.</span><span class="n">get_dag</span><span class="p">(</span><span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;hello_world&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">dagbag</span><span class="o">.</span><span class="n">import_errors</span> <span class="o">==</span> <span class="p">{}</span>
    <span class="k">assert</span> <span class="n">dag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">dag</span><span class="o">.</span><span class="n">tasks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
<p><strong>Unit test a DAG structure:</strong>
This is an example test want to verify the structure of a code-generated DAG against a dict object</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">assert_dag_dict_equal</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">dag</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">dag</span><span class="o">.</span><span class="n">task_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">==</span> <span class="n">source</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">task_id</span><span class="p">,</span> <span class="n">downstream_list</span> <span class="ow">in</span> <span class="n">source</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">dag</span><span class="o">.</span><span class="n">has_task</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
        <span class="n">task</span> <span class="o">=</span> <span class="n">dag</span><span class="o">.</span><span class="n">get_task</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">task</span><span class="o">.</span><span class="n">downstream_task_ids</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">downstream_list</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_dag</span><span class="p">():</span>
    <span class="n">assert_dag_dict_equal</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;DummyInstruction_0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;DummyInstruction_1&quot;</span><span class="p">],</span>
            <span class="s2">&quot;DummyInstruction_1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;DummyInstruction_2&quot;</span><span class="p">],</span>
            <span class="s2">&quot;DummyInstruction_2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;DummyInstruction_3&quot;</span><span class="p">],</span>
            <span class="s2">&quot;DummyInstruction_3&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">},</span>
        <span class="n">dag</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<p><strong>Unit test for custom operator:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">import</span> <span class="nn">pendulum</span>
<span class="kn">import</span> <span class="nn">pytest</span>

<span class="kn">from</span> <span class="nn">airflow</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="kn">from</span> <span class="nn">airflow.utils.state</span> <span class="kn">import</span> <span class="n">DagRunState</span><span class="p">,</span> <span class="n">TaskInstanceState</span>
<span class="kn">from</span> <span class="nn">airflow.utils.types</span> <span class="kn">import</span> <span class="n">DagRunType</span>

<span class="n">DATA_INTERVAL_START</span> <span class="o">=</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="s2">&quot;UTC&quot;</span><span class="p">)</span>
<span class="n">DATA_INTERVAL_END</span> <span class="o">=</span> <span class="n">DATA_INTERVAL_START</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">TEST_DAG_ID</span> <span class="o">=</span> <span class="s2">&quot;my_custom_operator_dag&quot;</span>
<span class="n">TEST_TASK_ID</span> <span class="o">=</span> <span class="s2">&quot;my_custom_operator_task&quot;</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">dag</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">DAG</span><span class="p">(</span>
        <span class="n">dag_id</span><span class="o">=</span><span class="n">TEST_DAG_ID</span><span class="p">,</span>
        <span class="n">schedule</span><span class="o">=</span><span class="s2">&quot;@daily&quot;</span><span class="p">,</span>
        <span class="n">start_date</span><span class="o">=</span><span class="n">DATA_INTERVAL_START</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">dag</span><span class="p">:</span>
        <span class="n">MyCustomOperator</span><span class="p">(</span>
            <span class="n">task_id</span><span class="o">=</span><span class="n">TEST_TASK_ID</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;s3://bucket/some/prefix&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">dag</span>


<span class="k">def</span> <span class="nf">test_my_custom_operator_execute_no_trigger</span><span class="p">(</span><span class="n">dag</span><span class="p">):</span>
    <span class="n">dagrun</span> <span class="o">=</span> <span class="n">dag</span><span class="o">.</span><span class="n">create_dagrun</span><span class="p">(</span>
        <span class="n">state</span><span class="o">=</span><span class="n">DagRunState</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">,</span>
        <span class="n">execution_date</span><span class="o">=</span><span class="n">DATA_INTERVAL_START</span><span class="p">,</span>
        <span class="n">data_interval</span><span class="o">=</span><span class="p">(</span><span class="n">DATA_INTERVAL_START</span><span class="p">,</span> <span class="n">DATA_INTERVAL_END</span><span class="p">),</span>
        <span class="n">start_date</span><span class="o">=</span><span class="n">DATA_INTERVAL_END</span><span class="p">,</span>
        <span class="n">run_type</span><span class="o">=</span><span class="n">DagRunType</span><span class="o">.</span><span class="n">MANUAL</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ti</span> <span class="o">=</span> <span class="n">dagrun</span><span class="o">.</span><span class="n">get_task_instance</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="n">TEST_TASK_ID</span><span class="p">)</span>
    <span class="n">ti</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="n">dag</span><span class="o">.</span><span class="n">get_task</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="n">TEST_TASK_ID</span><span class="p">)</span>
    <span class="n">ti</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">ignore_ti_state</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">ti</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">TaskInstanceState</span><span class="o">.</span><span class="n">SUCCESS</span>
    <span class="c1"># Assert something related to tasks results.</span>
</pre></div>
</div>
</div>
<div class="section" id="self-checks">
<h3>Self-Checks<a class="headerlink" href="#self-checks" title="Permalink to this heading">¶</a></h3>
<p>You can also implement checks in a DAG to make sure the tasks are producing the results as expected.
As an example, if you have a task that pushes data to S3, you can implement a check in the next task. For example, the check could
make sure that the partition is created in S3 and perform some simple checks to determine if the data is correct.</p>
<p>Similarly, if you have a task that starts a microservice in Kubernetes or Mesos, you should check if the service has started or not using <a class="reference external" href="/docs/apache-airflow-providers-http/stable/_api/airflow/providers/http/sensors/http/index.html#airflow.providers.http.sensors.http.HttpSensor" title="(in apache-airflow-providers-http v4.6.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">airflow.providers.http.sensors.http.HttpSensor</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">task</span> <span class="o">=</span> <span class="n">PushToS3</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">check</span> <span class="o">=</span> <span class="n">S3KeySensor</span><span class="p">(</span>
    <span class="n">task_id</span><span class="o">=</span><span class="s2">&quot;check_parquet_exists&quot;</span><span class="p">,</span>
    <span class="n">bucket_key</span><span class="o">=</span><span class="s2">&quot;s3://bucket/key/foo.parquet&quot;</span><span class="p">,</span>
    <span class="n">poke_interval</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">task</span> <span class="o">&gt;&gt;</span> <span class="n">check</span>
</pre></div>
</div>
</div>
<div class="section" id="staging-environment">
<h3>Staging environment<a class="headerlink" href="#staging-environment" title="Permalink to this heading">¶</a></h3>
<p>If possible, keep a staging environment to test the complete DAG run before deploying in the production.
Make sure your DAG is parameterized to change the variables, e.g., the output path of S3 operation or the database used to read the configuration.
Do not hard code values inside the DAG and then change them manually according to the environment.</p>
<p>You can use environment variables to parameterize the DAG.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">dest</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MY_DAG_DEST_PATH&quot;</span><span class="p">,</span> <span class="s2">&quot;s3://default-target/path/&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mocking-variables-and-connections">
<h2>Mocking variables and connections<a class="headerlink" href="#mocking-variables-and-connections" title="Permalink to this heading">¶</a></h2>
<p>When you write tests for code that uses variables or a connection, you must ensure that they exist when you run the tests. The obvious solution is to save these objects to the database so they can be read while your code is executing. However, reading and writing objects to the database are burdened with additional time overhead. In order to speed up the test execution, it is worth simulating the existence of these objects without saving them to the database. For this, you can create environment variables with mocking <a class="reference external" href="https://docs.python.org/3/library/os.html#os.environ" title="(in Python v3.12)"><code class="xref any docutils literal notranslate"><span class="pre">os.environ</span></code></a> using <code class="xref py py-meth docutils literal notranslate"><span class="pre">unittest.mock.patch.dict()</span></code>.</p>
<p>For variable, use <span class="target" id="index-0"></span><a class="reference internal" href="cli-and-env-variables-ref.html#envvar-AIRFLOW_VAR_-KEY"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">AIRFLOW_VAR_{KEY}</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">mock</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="s2">&quot;os.environ&quot;</span><span class="p">,</span> <span class="n">AIRFLOW_VAR_KEY</span><span class="o">=</span><span class="s2">&quot;env-value&quot;</span><span class="p">):</span>
    <span class="k">assert</span> <span class="s2">&quot;env-value&quot;</span> <span class="o">==</span> <span class="n">Variable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For connection, use <span class="target" id="index-1"></span><a class="reference internal" href="cli-and-env-variables-ref.html#envvar-AIRFLOW_CONN_-CONN_ID"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">AIRFLOW_CONN_{CONN_ID}</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span>
    <span class="n">conn_type</span><span class="o">=</span><span class="s2">&quot;gcpssh&quot;</span><span class="p">,</span>
    <span class="n">login</span><span class="o">=</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;conn-host&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">conn_uri</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">get_uri</span><span class="p">()</span>
<span class="k">with</span> <span class="n">mock</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="s2">&quot;os.environ&quot;</span><span class="p">,</span> <span class="n">AIRFLOW_CONN_MY_CONN</span><span class="o">=</span><span class="n">conn_uri</span><span class="p">):</span>
    <span class="k">assert</span> <span class="s2">&quot;cat&quot;</span> <span class="o">==</span> <span class="n">Connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;my_conn&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">login</span>
</pre></div>
</div>
</div>
<div class="section" id="metadata-db-maintenance">
<h2>Metadata DB maintenance<a class="headerlink" href="#metadata-db-maintenance" title="Permalink to this heading">¶</a></h2>
<p>Over time, the metadata database will increase its storage footprint as more DAG and task runs and event logs accumulate.</p>
<p>You can use the Airflow CLI to purge old data with the command <code class="docutils literal notranslate"><span class="pre">airflow</span> <span class="pre">db</span> <span class="pre">clean</span></code>.</p>
<p>See <a class="reference internal" href="howto/usage-cli.html#cli-db-clean"><span class="std std-ref">db clean usage</span></a> for more details.</p>
</div>
<div class="section" id="upgrades-and-downgrades">
<h2>Upgrades and downgrades<a class="headerlink" href="#upgrades-and-downgrades" title="Permalink to this heading">¶</a></h2>
<div class="section" id="backup-your-database">
<h3>Backup your database<a class="headerlink" href="#backup-your-database" title="Permalink to this heading">¶</a></h3>
<p>It’s always a wise idea to backup the metadata database before undertaking any operation modifying the database.</p>
</div>
<div class="section" id="disable-the-scheduler">
<h3>Disable the scheduler<a class="headerlink" href="#disable-the-scheduler" title="Permalink to this heading">¶</a></h3>
<p>You might consider disabling the Airflow cluster while you perform such maintenance.</p>
<p>One way to do so would be to set the param <code class="docutils literal notranslate"><span class="pre">[scheduler]</span> <span class="pre">&gt;</span> <span class="pre">use_job_schedule</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code> and wait for any running DAGs to complete; after this no new DAG runs will be created unless externally triggered.</p>
<p>A <em>better</em> way (though it’s a bit more manual) is to use the <code class="docutils literal notranslate"><span class="pre">dags</span> <span class="pre">pause</span></code> command.  You’ll need to keep track of the DAGs that are paused before you begin this operation so that you know which ones to unpause after maintenance is complete.  First run <code class="docutils literal notranslate"><span class="pre">airflow</span> <span class="pre">dags</span> <span class="pre">list</span></code> and store the list of unpaused DAGs.  Then use this same list to run both <code class="docutils literal notranslate"><span class="pre">dags</span> <span class="pre">pause</span></code> for each DAG prior to maintenance, and <code class="docutils literal notranslate"><span class="pre">dags</span> <span class="pre">unpause</span></code> after.  A benefit of this is you can try un-pausing just one or two DAGs (perhaps dedicated <a class="reference internal" href="#integration-test-dags"><span class="std std-ref">test dags</span></a>) after the upgrade to make sure things are working before turning everything back on.</p>
</div>
<div class="section" id="add-integration-test-dags">
<span id="integration-test-dags"></span><h3>Add “integration test” DAGs<a class="headerlink" href="#add-integration-test-dags" title="Permalink to this heading">¶</a></h3>
<p>It can be helpful to add a couple “integration test” DAGs that use all the common services in your ecosystem (e.g. S3, Snowflake, Vault) but with test resources or “dev” accounts.  These test DAGs can be the ones you turn on <em>first</em> after an upgrade, because if they fail, it doesn’t matter and you can revert to your backup without negative consequences.  However, if they succeed, they should prove that your cluster is able to run tasks with the libraries and services that you need to use.</p>
<p>For example, if you use an external secrets backend, make sure you have a task that retrieves a connection.  If you use KubernetesPodOperator, add a task that runs <code class="docutils literal notranslate"><span class="pre">sleep</span> <span class="pre">30;</span> <span class="pre">echo</span> <span class="pre">&quot;hello&quot;</span></code>.  If you need to write to s3, do so in a test task.  And if you need to access a database, add a task that does <code class="docutils literal notranslate"><span class="pre">select</span> <span class="pre">1</span></code> from the server.</p>
</div>
<div class="section" id="prune-data-before-upgrading">
<h3>Prune data before upgrading<a class="headerlink" href="#prune-data-before-upgrading" title="Permalink to this heading">¶</a></h3>
<p>Some database migrations can be time-consuming.  If your metadata database is very large, consider pruning some of the old data with the <a class="reference internal" href="howto/usage-cli.html#cli-db-clean"><span class="std std-ref">db clean</span></a> command prior to performing the upgrade.  <em>Use with caution.</em></p>
</div>
</div>
<div class="section" id="handling-conflicting-complex-python-dependencies">
<span id="best-practices-handling-conflicting-complex-python-dependencies"></span><h2>Handling conflicting/complex Python dependencies<a class="headerlink" href="#handling-conflicting-complex-python-dependencies" title="Permalink to this heading">¶</a></h2>
<p>Airflow has many Python dependencies and sometimes the Airflow dependencies are conflicting with dependencies that your
task code expects. Since - by default - Airflow environment is just a single set of Python dependencies and single
Python environment, often there might also be cases that some of your tasks require different dependencies than other tasks
and the dependencies basically conflict between those tasks.</p>
<p>If you are using pre-defined Airflow Operators to talk to external services, there is not much choice, but usually those
operators will have dependencies that are not conflicting with basic Airflow dependencies. Airflow uses constraints mechanism
which means that you have a “fixed” set of dependencies that the community guarantees that Airflow can be installed with
(including all community providers) without triggering conflicts. However, you can upgrade the providers
independently and their constraints do not limit you, so the chance of a conflicting dependency is lower (you still have
to test those dependencies). Therefore, when you are using pre-defined operators, chance is that you will have
little, to no problems with conflicting dependencies.</p>
<p>However, when you are approaching Airflow in a more “modern way”, where you use TaskFlow Api and most of
your operators are written using custom python code, or when you want to write your own Custom Operator,
you might get to the point where the dependencies required by the custom code of yours are conflicting with those
of Airflow, or even that dependencies of several of your Custom Operators introduce conflicts between themselves.</p>
<p>There are a number of strategies that can be employed to mitigate the problem. And while dealing with
dependency conflict in custom operators is difficult, it’s actually quite a bit easier when it comes to
using <a class="reference internal" href="_api/airflow/operators/python/index.html#airflow.operators.python.PythonVirtualenvOperator" title="airflow.operators.python.PythonVirtualenvOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">airflow.operators.python.PythonVirtualenvOperator</span></code></a> or <a class="reference internal" href="_api/airflow/operators/python/index.html#airflow.operators.python.ExternalPythonOperator" title="airflow.operators.python.ExternalPythonOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">airflow.operators.python.ExternalPythonOperator</span></code></a>
- either directly using classic “operator” approach or by using tasks decorated with
<code class="docutils literal notranslate"><span class="pre">&#64;task.virtualenv</span></code> or <code class="docutils literal notranslate"><span class="pre">&#64;task.external_python</span></code> decorators if you use TaskFlow.</p>
<p>Let’s start from the strategies that are easiest to implement (having some limits and overhead), and
we will gradually go through those strategies that requires some changes in your Airflow deployment.</p>
<div class="section" id="using-pythonvirtualenvoperator">
<h3>Using PythonVirtualenvOperator<a class="headerlink" href="#using-pythonvirtualenvoperator" title="Permalink to this heading">¶</a></h3>
<p>This is simplest to use and most limited strategy. The PythonVirtualenvOperator allows you to dynamically
create a virtualenv that your Python callable function will execute in. In the modern
TaskFlow approach described in <a class="reference internal" href="tutorial/taskflow.html"><span class="doc">Working with TaskFlow</span></a>. this also can be done with decorating
your callable with <code class="docutils literal notranslate"><span class="pre">&#64;task.virtualenv</span></code> decorator (recommended way of using the operator).
Each <a class="reference internal" href="_api/airflow/operators/python/index.html#airflow.operators.python.PythonVirtualenvOperator" title="airflow.operators.python.PythonVirtualenvOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">airflow.operators.python.PythonVirtualenvOperator</span></code></a> task can
have its own independent Python virtualenv (dynamically created every time the task is run) and can
specify fine-grained set of requirements that need to be installed for that task to execute.</p>
<p>The operator takes care of:</p>
<ul class="simple">
<li><p>creating the virtualenv based on your environment</p></li>
<li><p>serializing your Python callable and passing it to execution by the virtualenv Python interpreter</p></li>
<li><p>executing it and retrieving the result of the callable and pushing it via xcom if specified</p></li>
</ul>
<p>The benefits of the operator are:</p>
<ul class="simple">
<li><p>There is no need to prepare the venv upfront. It will be dynamically created before task is run, and
removed after it is finished, so there is nothing special (except having virtualenv package in your
airflow dependencies) to make use of multiple virtual environments</p></li>
<li><p>You can run tasks with different sets of dependencies on the same workers - thus Memory resources are
reused (though see below about the CPU overhead involved in creating the venvs).</p></li>
<li><p>In bigger installations, DAG Authors do not need to ask anyone to create the venvs for you.
As a DAG Author, you only have to have virtualenv dependency installed and you can specify and modify the
environments as you see fit.</p></li>
<li><p>No changes in deployment requirements - whether you use Local virtualenv, or Docker, or Kubernetes,
the tasks will work without adding anything to your deployment.</p></li>
<li><p>No need to learn more about containers, Kubernetes as a DAG Author. Only knowledge of Python requirements
is required to author DAGs this way.</p></li>
</ul>
<p>There are certain limitations and overhead introduced by this operator:</p>
<ul class="simple">
<li><p>Your python callable has to be serializable. There are a number of python objects that are not serializable
using standard <code class="docutils literal notranslate"><span class="pre">pickle</span></code> library. You can mitigate some of those limitations by using <code class="docutils literal notranslate"><span class="pre">dill</span></code> library
but even that library does not solve all the serialization limitations.</p></li>
<li><p>All dependencies that are not available in the Airflow environment must be locally imported in the callable you
use and the top-level Python code of your DAG should not import/use those libraries.</p></li>
<li><p>The virtual environments are run in the same operating system, so they cannot have conflicting system-level
dependencies (<code class="docutils literal notranslate"><span class="pre">apt</span></code> or <code class="docutils literal notranslate"><span class="pre">yum</span></code> installable packages). Only Python dependencies can be independently
installed in those environments.</p></li>
<li><p>The operator adds a CPU, networking and elapsed time overhead for running each task - Airflow has
to re-create the virtualenv from scratch for each task</p></li>
<li><p>The workers need to have access to PyPI or private repositories to install dependencies</p></li>
<li><p>The dynamic creation of virtualenv is prone to transient failures (for example when your repo is not available
or when there is a networking issue with reaching the repository)</p></li>
<li><p>It’s easy to  fall into a “too” dynamic environment - since the dependencies you install might get upgraded
and their transitive dependencies might get independent upgrades you might end up with the situation where
your task will stop working because someone released a new version of a dependency or you might fall
a victim of “supply chain” attack where new version of a dependency might become malicious</p></li>
<li><p>The tasks are only isolated from each other via running in different environments. This makes it possible
that running tasks will still interfere with each other - for example subsequent tasks executed on the
same worker might be affected by previous tasks creating/modifying files etc.</p></li>
</ul>
<p>You can see detailed examples of using <a class="reference internal" href="_api/airflow/operators/python/index.html#airflow.operators.python.PythonVirtualenvOperator" title="airflow.operators.python.PythonVirtualenvOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">airflow.operators.python.PythonVirtualenvOperator</span></code></a> in
<a class="reference internal" href="tutorial/taskflow.html#taskflow-virtualenv-example"><span class="std std-ref">Taskflow Virtualenv example</span></a></p>
</div>
<div class="section" id="using-externalpythonoperator">
<h3>Using ExternalPythonOperator<a class="headerlink" href="#using-externalpythonoperator" title="Permalink to this heading">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.4.</span></p>
</div>
<p>A bit more involved but with significantly less overhead, security, stability problems is to use the
<code class="xref py py-class docutils literal notranslate"><span class="pre">airflow.operators.python.ExternalPythonOperator`</span></code>. In the modern
TaskFlow approach described in <a class="reference internal" href="tutorial/taskflow.html"><span class="doc">Working with TaskFlow</span></a>. this also can be done with decorating
your callable with <code class="docutils literal notranslate"><span class="pre">&#64;task.external_python</span></code> decorator (recommended way of using the operator).
It requires, however, that you have a pre-existing, immutable Python environment, that is prepared upfront.
Unlike in <a class="reference internal" href="_api/airflow/operators/python/index.html#airflow.operators.python.PythonVirtualenvOperator" title="airflow.operators.python.PythonVirtualenvOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">airflow.operators.python.PythonVirtualenvOperator</span></code></a> you cannot add new dependencies
to such pre-existing environment. All dependencies you need should be added upfront in your environment
and available in all the workers in case your Airflow runs in a distributed environment.</p>
<p>This way you avoid the overhead and problems of re-creating the virtual environment but they have to be
prepared and deployed together with Airflow installation. Usually people who manage Airflow installation
need to be involved, and in bigger installations those are usually different people than DAG Authors
(DevOps/System Admins).</p>
<p>Those virtual environments can be prepared in various ways - if you use LocalExecutor they just need to be installed
at the machine where scheduler is run, if you are using distributed Celery virtualenv installations, there
should be a pipeline that installs those virtual environments across multiple machines, finally if you are using
Docker Image (for example via Kubernetes), the virtualenv creation should be added to the pipeline of
your custom image building.</p>
<p>The benefits of the operator are:</p>
<ul class="simple">
<li><p>No setup overhead when running the task. The virtualenv is ready when you start running a task.</p></li>
<li><p>You can run tasks with different sets of dependencies on the same workers - thus all resources are reused.</p></li>
<li><p>There is no need to have access by workers to PyPI or private repositories. Less chance for transient
errors resulting from networking.</p></li>
<li><p>The dependencies can be pre-vetted by the admins and your security team, no unexpected, new code will
be added dynamically. This is good for both, security and stability.</p></li>
<li><p>Limited impact on your deployment - you do not need to switch to Docker containers or Kubernetes to
make a good use of the operator.</p></li>
<li><p>No need to learn more about containers, Kubernetes as a DAG Author. Only knowledge of Python, requirements
is required to author DAGs this way.</p></li>
</ul>
<p>The drawbacks:</p>
<ul class="simple">
<li><p>Your environment needs to have the virtual environments prepared upfront. This usually means that you
cannot change it on the fly, adding new or changing requirements require at least an Airflow re-deployment
and iteration time when you work on new versions might be longer.</p></li>
<li><p>Your python callable has to be serializable. There are a number of python objects that are not serializable
using standard <code class="docutils literal notranslate"><span class="pre">pickle</span></code> library. You can mitigate some of those limitations by using <code class="docutils literal notranslate"><span class="pre">dill</span></code> library
but even that library does not solve all the serialization limitations.</p></li>
<li><p>All dependencies that are not available in Airflow environment must be locally imported in the callable you
use and the top-level Python code of your DAG should not import/use those libraries.</p></li>
<li><p>The virtual environments are run in the same operating system, so they cannot have conflicting system-level
dependencies (<code class="docutils literal notranslate"><span class="pre">apt</span></code> or <code class="docutils literal notranslate"><span class="pre">yum</span></code> installable packages). Only Python dependencies can be independently
installed in those environments</p></li>
<li><p>The tasks are only isolated from each other via running in different environments. This makes it possible
that running tasks will still interfere with each other - for example subsequent tasks executed on the
same worker might be affected by previous tasks creating/modifying files et.c</p></li>
</ul>
<p>You can think about the <code class="docutils literal notranslate"><span class="pre">PythonVirtualenvOperator</span></code> and <code class="docutils literal notranslate"><span class="pre">ExternalPythonOperator</span></code> as counterparts -
that make it smoother to move from development phase to production phase. As a DAG author you’d normally
iterate with dependencies and develop your DAG using <code class="docutils literal notranslate"><span class="pre">PythonVirtualenvOperator</span></code> (thus decorating
your tasks with <code class="docutils literal notranslate"><span class="pre">&#64;task.virtualenv</span></code> decorators) while after the iteration and changes you would likely
want to change it for production to switch to the <code class="docutils literal notranslate"><span class="pre">ExternalPythonOperator</span></code> (and <code class="docutils literal notranslate"><span class="pre">&#64;task.external_python</span></code>)
after your DevOps/System Admin teams deploy your new dependencies in pre-existing virtualenv in production.
The nice thing about this is that you can switch the decorator back at any time and continue
developing it “dynamically” with <code class="docutils literal notranslate"><span class="pre">PythonVirtualenvOperator</span></code>.</p>
<p>You can see detailed examples of using <a class="reference internal" href="_api/airflow/operators/python/index.html#airflow.operators.python.ExternalPythonOperator" title="airflow.operators.python.ExternalPythonOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">airflow.operators.python.ExternalPythonOperator</span></code></a> in
<a class="reference internal" href="tutorial/taskflow.html#taskflow-external-python-example"><span class="std std-ref">Taskflow External Python example</span></a></p>
</div>
<div class="section" id="using-dockeroperator-or-kubernetes-pod-operator">
<h3>Using DockerOperator or Kubernetes Pod Operator<a class="headerlink" href="#using-dockeroperator-or-kubernetes-pod-operator" title="Permalink to this heading">¶</a></h3>
<p>Another strategy is to use the <a class="reference external" href="/docs/apache-airflow-providers-docker/stable/_api/airflow/providers/docker/operators/docker/index.html#airflow.providers.docker.operators.docker.DockerOperator" title="(in apache-airflow-providers-docker v3.8.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">airflow.providers.docker.operators.docker.DockerOperator</span></code></a>
<a class="reference external" href="/docs/apache-airflow-providers-cncf-kubernetes/stable/_api/airflow/providers/cncf/kubernetes/operators/pod/index.html#airflow.providers.cncf.kubernetes.operators.pod.KubernetesPodOperator" title="(in apache-airflow-providers-cncf-kubernetes v7.8.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">airflow.providers.cncf.kubernetes.operators.pod.KubernetesPodOperator</span></code></a>
Those require that Airflow has access to a Docker engine or Kubernetes cluster.</p>
<p>Similarly as in case of Python operators, the taskflow decorators are handy for you if you would like to
use those operators to execute your callable Python code.</p>
<p>However, it is far more involved - you need to understand how Docker/Kubernetes Pods work if you want to use
this approach, but the tasks are fully isolated from each other and you are not even limited to running
Python code. You can write your tasks in any Programming language you want. Also your dependencies are
fully independent from Airflow ones (including the system level dependencies) so if your task require
a very different environment, this is the way to go.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.</span></p>
</div>
<p>As of version 2.2 of Airflow you can use <code class="docutils literal notranslate"><span class="pre">&#64;task.docker</span></code> decorator to run your functions with <code class="docutils literal notranslate"><span class="pre">DockerOperator</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.4.</span></p>
</div>
<p>As of version 2.2 of Airflow you can use <code class="docutils literal notranslate"><span class="pre">&#64;task.kubernetes</span></code> decorator to run your functions with <code class="docutils literal notranslate"><span class="pre">KubernetesPodOperator</span></code>.</p>
<p>The benefits of using those operators are:</p>
<ul class="simple">
<li><p>You can run tasks with different sets of both Python and system level dependencies, or even tasks
written in completely different language or even different processor architecture (x86 vs. arm).</p></li>
<li><p>The environment used to run the tasks enjoys the optimizations and immutability of containers, where a
similar set of dependencies can effectively reuse a number of cached layers of the image, so the
environment is optimized for the case where you have multiple similar, but different environments.</p></li>
<li><p>The dependencies can be pre-vetted by the admins and your security team, no unexpected, new code will
be added dynamically. This is good for both, security and stability.</p></li>
<li><p>Complete isolation between tasks. They cannot influence one another in other ways than using standard
Airflow XCom mechanisms.</p></li>
</ul>
<p>The drawbacks:</p>
<ul class="simple">
<li><p>There is an overhead to start the tasks. Usually not as big as when creating virtual environments dynamically,
but still significant (especially for the <code class="docutils literal notranslate"><span class="pre">KubernetesPodOperator</span></code>).</p></li>
<li><p>In case of TaskFlow decorators, the whole method to call needs to be serialized and sent over to the
Docker Container or Kubernetes Pod, and there are system-level limitations on how big the method can be.
Serializing, sending, and finally deserializing the method on remote end also adds an overhead.</p></li>
<li><p>There is a resources overhead coming from multiple processes needed. Running tasks in case of those
two operators requires at least two processes - one process (running in Docker Container or Kubernetes Pod)
executing the task, and a supervising process in the Airflow worker that submits the job to
Docker/Kubernetes and monitors the execution.</p></li>
<li><p>Your environment needs to have the container images ready upfront. This usually means that you
cannot change them on the fly. Adding system dependencies, modifying or changing Python requirements
requires an image rebuilding and publishing (usually in your private registry).
Iteration time when you work on new dependencies are usually longer and require the developer who is
iterating to build and use their own images during iterations if they change dependencies.
An appropriate deployment pipeline here is essential to be able to reliably maintain your deployment.</p></li>
<li><p>Your python callable has to be serializable if you want to run it via decorators, also in this case
all dependencies that are not available in Airflow environment must be locally imported in the callable you
use and the top-level Python code of your DAG should not import/use those libraries.</p></li>
<li><p>You need to understand more details about how Docker Containers or Kubernetes work. The abstraction
provided by those two are “leaky”, so you need to understand a bit more about resources, networking,
containers etc. in order to author a DAG that uses those operators.</p></li>
</ul>
<p>You can see detailed examples of using <code class="xref py py-class docutils literal notranslate"><span class="pre">airflow.operators.providers.Docker</span></code> in
<a class="reference internal" href="tutorial/taskflow.html#taskflow-docker-example"><span class="std std-ref">Taskflow Docker example</span></a>
and <a class="reference external" href="/docs/apache-airflow-providers-cncf-kubernetes/stable/_api/airflow/providers/cncf/kubernetes/operators/pod/index.html#airflow.providers.cncf.kubernetes.operators.pod.KubernetesPodOperator" title="(in apache-airflow-providers-cncf-kubernetes v7.8.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">airflow.providers.cncf.kubernetes.operators.pod.KubernetesPodOperator</span></code></a>
<a class="reference internal" href="tutorial/taskflow.html#taskflow-kubernetes-example"><span class="std std-ref">Taskflow Kubernetes example</span></a></p>
</div>
<div class="section" id="using-multiple-docker-images-and-celery-queues">
<h3>Using multiple Docker Images and Celery Queues<a class="headerlink" href="#using-multiple-docker-images-and-celery-queues" title="Permalink to this heading">¶</a></h3>
<p>There is a possibility (though it requires a deep knowledge of Airflow deployment) to run Airflow tasks
using multiple, independent Docker images. This can be achieved via allocating different tasks to different
Queues and configuring your Celery workers to use different images for different Queues. This, however,
(at least currently) requires a lot of manual deployment configuration and intrinsic knowledge of how
Airflow, Celery and Kubernetes works. Also it introduces quite some overhead for running the tasks - there
are less chances for resource reuse and it’s much more difficult to fine-tune such a deployment for
cost of resources without impacting the performance and stability.</p>
<p>One of the possible ways to make it more useful is
<a class="reference external" href="https://cwiki.apache.org/confluence/display/AIRFLOW/AIP-46+Runtime+isolation+for+airflow+tasks+and+dag+parsing">AIP-46 Runtime isolation for Airflow tasks and DAG parsing</a>.
and completion of <a class="reference external" href="https://cwiki.apache.org/confluence/display/AIRFLOW/AIP-43+DAG+Processor+separation">AIP-43 DAG Processor Separation</a>
Until those are implemented, there are very few benefits of using this approach and it is not recommended.</p>
<p>When those AIPs are implemented, however, this will open up the possibility of a more multi-tenant approach,
where multiple teams will be able to have completely isolated sets of dependencies that will be used across
the full lifecycle of a DAG - from parsing to execution.</p>
</div>
</div>
</div>


    <div class="pager" role="navigation" aria-label="related navigation">
            <a rel="prev" title="airflow.decorators.task_group" href="_api/airflow/decorators/task_group/index.html" >
                <button class="btn-hollow btn-blue bodytext__medium--cerulean-blue" accesskey="p">Previous</button>
            </a>
            <a rel="next" title="FAQ" href="faq.html" >
                <button class="btn-hollow btn-blue bodytext__medium--cerulean-blue" accesskey="n">Next</button>
            </a>
    </div>
                                    </div>

                                </div>
                            </div>
                    </div>
                </div>
    <div class="rating-container">
        <p class="bodytext__medium--greyish-brown font-weight-500">Was this entry helpful?</p>
        <div class="rating">

            <div id="rate-star-5" class="rate-star">
                <svg xmlns="http://www.w3.org/2000/svg" width="21.05" height="20.02" viewBox="0 0 21.05 20.02">
                    <g id="Group_806" data-name="Group 806" transform="translate(-774.404 -13.178)">
                        <path id="Path_715" d="M791.434 33.2l-6.5-3.42-6.5 3.42 1.242-7.243-5.262-5.13 7.273-1.057 3.252-6.59 3.252 6.59 7.273 1.057-5.262 5.13z" fill="#017cee" data-name="Path 715"></path>
                    </g>
                </svg>

            </div>

            <div id="rate-star-4" class="rate-star">
                <svg xmlns="http://www.w3.org/2000/svg" width="21.05" height="20.02" viewBox="0 0 21.05 20.02">
                    <g id="Group_806" data-name="Group 806" transform="translate(-774.404 -13.178)">
                        <path id="Path_715" d="M791.434 33.2l-6.5-3.42-6.5 3.42 1.242-7.243-5.262-5.13 7.273-1.057 3.252-6.59 3.252 6.59 7.273 1.057-5.262 5.13z" fill="#017cee" data-name="Path 715"></path>
                    </g>
                </svg>

            </div>

            <div id="rate-star-3" class="rate-star">
                <svg xmlns="http://www.w3.org/2000/svg" width="21.05" height="20.02" viewBox="0 0 21.05 20.02">
                    <g id="Group_806" data-name="Group 806" transform="translate(-774.404 -13.178)">
                        <path id="Path_715" d="M791.434 33.2l-6.5-3.42-6.5 3.42 1.242-7.243-5.262-5.13 7.273-1.057 3.252-6.59 3.252 6.59 7.273 1.057-5.262 5.13z" fill="#017cee" data-name="Path 715"></path>
                    </g>
                </svg>

            </div>

            <div id="rate-star-2" class="rate-star">
                <svg xmlns="http://www.w3.org/2000/svg" width="21.05" height="20.02" viewBox="0 0 21.05 20.02">
                    <g id="Group_806" data-name="Group 806" transform="translate(-774.404 -13.178)">
                        <path id="Path_715" d="M791.434 33.2l-6.5-3.42-6.5 3.42 1.242-7.243-5.262-5.13 7.273-1.057 3.252-6.59 3.252 6.59 7.273 1.057-5.262 5.13z" fill="#017cee" data-name="Path 715"></path>
                    </g>
                </svg>

            </div>

            <div id="rate-star-1" class="rate-star">
                <svg xmlns="http://www.w3.org/2000/svg" width="21.05" height="20.02" viewBox="0 0 21.05 20.02">
                    <g id="Group_806" data-name="Group 806" transform="translate(-774.404 -13.178)">
                        <path id="Path_715" d="M791.434 33.2l-6.5-3.42-6.5 3.42 1.242-7.243-5.262-5.13 7.273-1.057 3.252-6.59 3.252 6.59 7.273 1.057-5.262 5.13z" fill="#017cee" data-name="Path 715"></path>
                    </g>
                </svg>

            </div>

        </div>
    </div>
                
            </main>
            

            
            
    <nav class="wy-nav-side-toc">
        <div class="wy-menu-vertical">
            <ul>
<li><a class="reference internal" href="#">Best Practices</a><ul>
<li><a class="reference internal" href="#writing-a-dag">Writing a DAG</a><ul>
<li><a class="reference internal" href="#creating-a-custom-operator-hook">Creating a Custom Operator/Hook</a></li>
<li><a class="reference internal" href="#creating-a-task">Creating a task</a></li>
<li><a class="reference internal" href="#deleting-a-task">Deleting a task</a></li>
<li><a class="reference internal" href="#communication">Communication</a></li>
<li><a class="reference internal" href="#top-level-python-code">Top level Python Code</a></li>
<li><a class="reference internal" href="#how-to-check-if-my-code-is-top-level-code">How to check if my code is “top-level” code</a></li>
<li><a class="reference internal" href="#dynamic-dag-generation">Dynamic DAG Generation</a></li>
<li><a class="reference internal" href="#airflow-variables">Airflow Variables</a></li>
<li><a class="reference internal" href="#timetables">Timetables</a></li>
<li><a class="reference internal" href="#triggering-dags-after-changes">Triggering DAGs after changes</a></li>
<li><a class="reference internal" href="#example-of-watcher-pattern-with-trigger-rules">Example of watcher pattern with trigger rules</a></li>
<li><a class="reference internal" href="#using-airflowclusterpolicyskipdag-exception-in-cluster-policies-to-skip-specific-dags">Using AirflowClusterPolicySkipDag exception in cluster policies to skip specific DAGs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reducing-dag-complexity">Reducing DAG complexity</a></li>
<li><a class="reference internal" href="#testing-a-dag">Testing a DAG</a><ul>
<li><a class="reference internal" href="#dag-loader-test">DAG Loader Test</a></li>
<li><a class="reference internal" href="#unit-tests">Unit tests</a></li>
<li><a class="reference internal" href="#self-checks">Self-Checks</a></li>
<li><a class="reference internal" href="#staging-environment">Staging environment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mocking-variables-and-connections">Mocking variables and connections</a></li>
<li><a class="reference internal" href="#metadata-db-maintenance">Metadata DB maintenance</a></li>
<li><a class="reference internal" href="#upgrades-and-downgrades">Upgrades and downgrades</a><ul>
<li><a class="reference internal" href="#backup-your-database">Backup your database</a></li>
<li><a class="reference internal" href="#disable-the-scheduler">Disable the scheduler</a></li>
<li><a class="reference internal" href="#add-integration-test-dags">Add “integration test” DAGs</a></li>
<li><a class="reference internal" href="#prune-data-before-upgrading">Prune data before upgrading</a></li>
</ul>
</li>
<li><a class="reference internal" href="#handling-conflicting-complex-python-dependencies">Handling conflicting/complex Python dependencies</a><ul>
<li><a class="reference internal" href="#using-pythonvirtualenvoperator">Using PythonVirtualenvOperator</a></li>
<li><a class="reference internal" href="#using-externalpythonoperator">Using ExternalPythonOperator</a></li>
<li><a class="reference internal" href="#using-dockeroperator-or-kubernetes-pod-operator">Using DockerOperator or Kubernetes Pod Operator</a></li>
<li><a class="reference internal" href="#using-multiple-docker-images-and-celery-queues">Using multiple Docker Images and Celery Queues</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
    </nav>
            
        </div>
        


    







    
        
            
        
        <div class="base-layout--button">
            <a href="https://github.com/apache/airflow/edit/main/docs/apache-airflow/best-practices.rst" rel="nofollow">

                <button class="btn-hollow btn-brown btn-with-icon with-box-shadow button-fixed">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30.76" height="30">
                        <path d="M15.379 0a15.381 15.381 0 00-4.86 29.974c.769.141 1.05-.334 1.05-.741 0-.365-.013-1.332-.021-2.616-4.278.929-5.181-2.062-5.181-2.062a4.071 4.071 0 00-1.708-2.25c-1.4-.954.106-.935.106-.935a3.231 3.231 0 012.356 1.585 3.274 3.274 0 004.476 1.278 3.287 3.287 0 01.976-2.056c-3.415-.388-7.005-1.707-7.005-7.6a5.947 5.947 0 011.583-4.127 5.53 5.53 0 01.151-4.07s1.291-.413 4.229 1.577a14.577 14.577 0 017.7 0c2.936-1.99 4.225-1.577 4.225-1.577a5.523 5.523 0 01.153 4.07 5.937 5.937 0 011.581 4.127c0 5.909-3.6 7.209-7.022 7.589a3.672 3.672 0 011.044 2.848c0 2.056-.019 3.715-.019 4.219 0 .411.277.89 1.057.74A15.382 15.382 0 0015.378.001z" data-name="Path 224" fill="#51504f" fill-rule="evenodd"></path>
                    </svg>

                    <span class="bodytext__medium--brownish-grey">Suggest a change on this page</span>
                </button>
            </a>
        </div>
    

    </div>


    

<footer>
    <div class="footer-section footer-section__media-section">
        <div class="d-flex align-items-center">

            <a class="footer-section__media-section--link" target="_blank" href="https://github.com/apache/airflow">
                <svg xmlns="http://www.w3.org/2000/svg" width="46.14" height="45" viewBox="0 0 46.14 45">
                    <path id="Path_207" d="M228.962 1078.578a23.072 23.072 0 0 0-7.29 44.96c1.154.212 1.574-.5 1.574-1.112 0-.548-.02-2-.031-3.924-6.417 1.394-7.771-3.093-7.771-3.093a6.109 6.109 0 0 0-2.562-3.375c-2.095-1.431.159-1.4.159-1.4a4.846 4.846 0 0 1 3.533 2.377c2.058 3.525 5.4 2.507 6.714 1.917a4.926 4.926 0 0 1 1.464-3.084c-5.123-.582-10.508-2.562-10.508-11.4a8.919 8.919 0 0 1 2.374-6.191 8.3 8.3 0 0 1 .226-6.105s1.937-.62 6.344 2.365a21.857 21.857 0 0 1 11.551 0c4.4-2.985 6.338-2.365 6.338-2.365a8.284 8.284 0 0 1 .23 6.105 8.9 8.9 0 0 1 2.371 6.191c0 8.862-5.393 10.812-10.533 11.384a5.506 5.506 0 0 1 1.566 4.272c0 3.084-.028 5.572-.028 6.329 0 .617.415 1.334 1.586 1.109a23.073 23.073 0 0 0-7.308-44.958z" fill="#fff" fill-rule="evenodd" data-name="Path 207" transform="translate(-205.894 -1078.578)"></path>
                </svg>

            </a>

            <a class="footer-section__media-section--link" target="_blank" href="https://github.com/apache/airflow/issues">
                <svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" viewBox="0 0 45 45">
                    <g id="Group_210" data-name="Group 210" transform="translate(-339.789 -1315.282)">
                        <path id="Path_218" d="M394.82 1315.282h-21.671a9.784 9.784 0 0 0 9.784 9.778h3.986v3.857a9.784 9.784 0 0 0 9.784 9.771v-21.523a1.884 1.884 0 0 0-1.883-1.883z" fill="#fff" data-name="Path 218" transform="translate(-11.914)"></path>
                        <path id="Path_219" d="M378.14 1332.072h-21.671a9.778 9.778 0 0 0 9.778 9.778h4.018v3.857a9.784 9.784 0 0 0 9.752 9.778v-21.536a1.877 1.877 0 0 0-1.877-1.877z" fill="#fff" data-name="Path 219" transform="translate(-5.957 -5.996)"></path>
                        <path id="Path_220" d="M361.46 1348.862h-21.671a9.778 9.778 0 0 0 9.778 9.778h3.992v3.857a9.778 9.778 0 0 0 9.778 9.778v-21.529a1.883 1.883 0 0 0-1.877-1.884z" fill="#fff" data-name="Path 220" transform="translate(0 -11.993)"></path>
                    </g>
                </svg>

            </a>

            <a class="footer-section__media-section--link" target="_blank" href="https://s.apache.org/airflow-slack">
                <svg xmlns="http://www.w3.org/2000/svg" width="45.073" height="45.073" viewBox="0 0 45.073 45.073">
                    <g id="Group_208" data-name="Group 208" transform="translate(-661.145 -806.287)">
                        <g id="Group_204" data-name="Group 204" transform="translate(661.145 830.01)">
                            <path id="Path_208" d="M670.634 856.859a4.744 4.744 0 1 1-4.744-4.744h4.744z" fill="#fff" data-name="Path 208" transform="translate(-661.145 -852.115)"></path>
                            <path id="Path_209" d="M684.059 856.859a4.744 4.744 0 0 1 9.489 0v11.861a4.744 4.744 0 1 1-9.489 0z" fill="#fff" data-name="Path 209" transform="translate(-672.198 -852.115)"></path>
                        </g>
                        <g id="Group_205" data-name="Group 205" transform="translate(661.145 806.287)">
                            <path id="Path_210" d="M688.8 815.776a4.744 4.744 0 1 1 4.744-4.745v4.745z" fill="#fff" data-name="Path 210" transform="translate(-672.198 -806.287)"></path>
                            <path id="Path_211" d="M677.751 829.2a4.744 4.744 0 0 1 0 9.489H665.89a4.744 4.744 0 1 1 0-9.489z" fill="#fff" data-name="Path 211" transform="translate(-661.145 -817.34)"></path>
                        </g>
                        <g id="Group_206" data-name="Group 206" transform="translate(684.868 806.287)">
                            <path id="Path_212" d="M729.887 833.945a4.744 4.744 0 1 1 4.745 4.745h-4.745z" fill="#fff" data-name="Path 212" transform="translate(-718.026 -817.34)"></path>
                            <path id="Path_213" d="M716.462 822.893a4.744 4.744 0 1 1-9.489 0v-11.862a4.744 4.744 0 0 1 9.489 0z" fill="#fff" data-name="Path 213" transform="translate(-706.973 -806.287)"></path>
                        </g>
                        <g id="Group_207" data-name="Group 207" transform="translate(684.868 830.01)">
                            <path id="Path_214" d="M711.718 875.029a4.744 4.744 0 1 1-4.745 4.744v-4.744z" fill="#fff" data-name="Path 214" transform="translate(-706.973 -863.168)"></path>
                            <path id="Path_215" d="M711.718 861.6a4.744 4.744 0 1 1 0-9.489h11.861a4.744 4.744 0 0 1 0 9.489z" fill="#fff" data-name="Path 215" transform="translate(-706.973 -852.115)"></path>
                        </g>
                    </g>
                </svg>

            </a>

            <a class="footer-section__media-section--link" target="_blank" href="https://stackoverflow.com/questions/tagged/airflow">
                <svg xmlns="http://www.w3.org/2000/svg" width="37.647" height="44.6" viewBox="0 0 37.647 44.6">
                    <g id="Group_209" data-name="Group 209" transform="translate(-645.2 -975.455)">
                        <path id="Path_216" d="M677.028 1043.1v-11.948h3.966v15.914H645.2v-15.914h3.966v11.948z" fill="#fff" data-name="Path 216" transform="translate(0 -27.014)"></path>
                        <path id="Path_217" d="M661.012 1003.008l19.467 4.069.824-3.914-19.467-4.069zm2.575-9.27l18.025 8.395 1.648-3.605-18.025-8.446zm5-8.858l15.3 12.721 2.524-3.039-15.3-12.721zm9.888-9.425l-3.193 2.369 11.845 15.965 3.193-2.369zm-17.875 36.617h19.879v-3.966H660.6z" fill="#fff" data-name="Path 217" transform="translate(-7.469)"></path>
                    </g>
                </svg>

            </a>

            <a class="footer-section__media-section--link" target="_blank" href="https://twitter.com/ApacheAirflow">
                <svg xmlns="http://www.w3.org/2000/svg" width="44.355" height="44.355" viewBox="0 0 44.355 44.355">
                    <g id="Group_211" data-name="Group 211" transform="translate(-503 -1382.2)">
                        <path id="Path_221" d="M541.811 1382.2h-33.267a5.546 5.546 0 0 0-5.544 5.544v33.266a5.547 5.547 0 0 0 5.544 5.545h33.267a5.546 5.546 0 0 0 5.544-5.545v-33.266a5.546 5.546 0 0 0-5.544-5.544zm-5.611 16.533c.011.244.011.488.011.732 0 7.507-5.722 16.178-16.179 16.178a16.173 16.173 0 0 1-8.7-2.539 10.92 10.92 0 0 0 1.353.078 11.4 11.4 0 0 0 7.064-2.44 5.685 5.685 0 0 1-5.311-3.947 5.725 5.725 0 0 0 2.561-.1 5.7 5.7 0 0 1-4.557-5.578v-.078a5.752 5.752 0 0 0 2.572.71 5.709 5.709 0 0 1-1.763-7.6 16.146 16.146 0 0 0 11.721 5.944 6.282 6.282 0 0 1-.144-1.3 5.688 5.688 0 0 1 9.836-3.892 11.3 11.3 0 0 0 3.615-1.375 5.721 5.721 0 0 1-2.506 3.149 11.538 11.538 0 0 0 3.271-.9 11.585 11.585 0 0 1-2.844 2.958z" fill="#fff" data-name="Path 221"></path>
                    </g>
                </svg>

            </a>

            <a class="footer-section__media-section--link" target="_blank" href="https://www.youtube.com/channel/UCSXwxpWZQ7XZ1WL3wqevChA">
                <svg xmlns="http://www.w3.org/2000/svg" width="49.594" height="34.941" viewBox="0 0 49.594 34.941">
                    <path id="Path_223" d="M1124.557 1230a6.232 6.232 0 0 0-4.385-4.413c-3.867-1.043-19.376-1.043-19.376-1.043s-15.508 0-19.376 1.043a6.232 6.232 0 0 0-4.385 4.413c-1.036 3.893-1.036 12.014-1.036 12.014s0 8.122 1.036 12.015a6.232 6.232 0 0 0 4.385 4.413c3.867 1.043 19.376 1.043 19.376 1.043s15.509 0 19.376-1.043a6.232 6.232 0 0 0 4.385-4.413c1.036-3.893 1.036-12.015 1.036-12.015s.001-8.123-1.036-12.014zm-28.833 19.388v-14.748l12.962 7.374z" fill="#fff" data-name="Path 223" transform="translate(-1076 -1224.542)"></path>
                </svg>

            </a>

        </div>
        

        <div class="footer-section__media-section--button-with-text">
            <span class="footer-section__media-section--text">Want to be a part of Apache Airflow?</span>
            <a href="/community">

                <button id="" class="btn-filled bodytext__medium--white ">Join community</button>

            </a>
        </div>
        

    </div>
    <div class="footer-section footer-section__policies-section">
        <div class="footer-section">
            <span>© The Apache Software Foundation <script>document.write(new Date().getFullYear())</script></span>
            <div class="footer-section__policies-section--policies">

                <a href="https://www.apache.org/licenses/" class="footer-section__policies-section--policy-item">
                    <span>License</span>
                </a>

                <a href="https://www.apache.org/foundation/sponsorship.html" class="footer-section__policies-section--policy-item">
                    <span>Donate</span>
                </a>

                <a href="https://www.apache.org/foundation/thanks.html" class="footer-section__policies-section--policy-item">
                    <span>Thanks</span>
                </a>

                <a href="https://www.apache.org/security/" class="footer-section__policies-section--policy-item">
                    <span>Security</span>
                </a>
                

            </div>
        </div>
        <span class="footer-section__policies-section--disclaimer">
            Apache Airflow, Apache, Airflow, the Airflow logo, and the Apache feather logo are either registered trademarks or trademarks of The Apache Software Foundation.
            All other products or name brands are trademarks of their respective holders, including The Apache Software Foundation.
        </span>
    </div>
</footer>
    <script type="text/javascript" src="_static/_gen/js/docs.js"></script>
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/js/globaltoc.js"></script>
        <script src="_static/gh-jira-links.js"></script>
</body>
</html>